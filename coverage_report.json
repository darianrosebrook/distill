============================= test session starts ==============================
platform darwin -- Python 3.11.13, pytest-9.0.1, pluggy-1.6.0 -- /Users/darianrosebrook/Desktop/Projects/distill/venv/bin/python3.11
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /Users/darianrosebrook/Desktop/Projects/distill
configfile: pytest.ini
testpaths: tests
plugins: anyio-4.11.0, hypothesis-6.147.0, timeout-2.4.0, cov-7.0.0
timeout: 30.0s
timeout method: thread
timeout func_only: False
collecting ... collected 3212 items

tests/ci/test_broker_fixtures_hit_rate.py::test_broker_fixtures_hit_rate PASSED [  0%]
tests/ci/test_broker_fixtures_hit_rate.py::test_broker_miss_for_unknown_key PASSED [  0%]
tests/ci/test_sharding_determinism.py::test_stable_shard PASSED          [  0%]
tests/ci/test_sharding_determinism.py::test_stable_shard_distribution PASSED [  0%]
tests/ci/test_sharding_determinism.py::test_select_shard_with_sample_id PASSED [  0%]
tests/ci/test_sharding_determinism.py::test_select_shard_without_sample_id PASSED [  0%]
tests/ci/test_sharding_determinism.py::test_select_shard_single_shard PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPytorchToCoreML::test_convert_pytorch_to_coreml_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPytorchToCoreML::test_convert_pytorch_to_coreml_with_halt_head PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPytorchToCoreML::test_convert_pytorch_to_coreml_missing_dependencies PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertOnnxToCoreML::test_convert_onnx_to_coreml_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertOnnxToCoreML::test_convert_onnx_to_coreml_conversion_failure PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestCreatePlaceholder::test_create_placeholder_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestCreatePlaceholder::test_create_placeholder_directory_creation PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestLoadContract::test_load_contract_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestLoadContract::test_load_contract_file_not_found PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestLoadContract::test_load_contract_invalid_json PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPyTorchToCoreML::test_convert_pytorch_to_coreml_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPyTorchToCoreML::test_convert_pytorch_to_coreml_with_ane_optimization PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPyTorchToCoreML::test_convert_pytorch_to_coreml_ane_incompatible PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertPyTorchToCoreML::test_convert_pytorch_to_coreml_conversion_failure PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertONNXToCoreML::test_convert_onnx_to_coreml_success PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertONNXToCoreML::test_convert_onnx_to_coreml_with_custom_target PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestConvertONNXToCoreML::test_convert_onnx_to_coreml_file_not_found PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestMainFunction::test_main_pytorch_conversion PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestMainFunction::test_main_onnx_conversion PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestMainFunction::test_main_conversion_failure_with_placeholder PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestMainFunction::test_main_invalid_backend PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestMainFunction::test_main_contract_not_found PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestANEOptimizations::test_detect_int64_tensors_fallback PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestANEOptimizations::test_check_ane_op_compatibility_fallback PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestCoreMLConversionIntegration::test_conversion_workflow_pytorch PASSED [  0%]
tests/conversion/test_convert_coreml.py::TestCoreMLConversionIntegration::test_conversion_error_handling PASSED [  1%]
tests/conversion/test_convert_coreml.py::TestCoreMLConversionIntegration::test_version_gate_integration PASSED [  1%]
tests/conversion/test_convert_coreml.py::TestCoreMLConversionIntegration::test_conversion_parameter_validation PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_initialization PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_index_calculation PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_with_kv_cache PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_empty_cache PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_mixed_cache PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_missing_cache_args PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_single_token PASSED [  1%]
tests/conversion/test_export_onnx.py::TestDecodeWrapper::test_decode_wrapper_forward_batch_processing PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_both_modes PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_prefill_only PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_decode_only PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_config_not_found PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_invalid_config PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_fallback_config PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_model_loading_failure PASSED [  1%]
tests/conversion/test_export_onnx.py::TestMainFunction::test_main_onnx_export_failure PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_decode_wrapper_real_model_simulation PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_config_parsing_edge_cases PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_export_directory_creation PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_export_file_naming PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_wrapper_cache_handling_edge_cases PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_mode_validation PASSED [  1%]
tests/conversion/test_export_onnx.py::TestONNXExportIntegration::test_checkpoint_loading_and_model_creation PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestPrefillWrapper::test_prefill_wrapper_init PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestPrefillWrapper::test_prefill_wrapper_forward_without_halt PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestPrefillWrapper::test_prefill_wrapper_forward_with_halt PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestPrefillWrapper::test_prefill_wrapper_forward_without_attn_mask PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestDecodeWrapper::test_decode_wrapper_init PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestDecodeWrapper::test_decode_wrapper_forward_single_token PASSED [  1%]
tests/conversion/test_export_pytorch.py::TestDecodeWrapper::test_decode_wrapper_forward_with_kv_cache PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportPrefill::test_export_prefill_success PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportPrefill::test_export_prefill_trace_failure PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportPrefill::test_export_prefill_with_halt_head PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportDecode::test_export_decode_success PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportDecode::test_export_decode_trace_failure PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportDecode::test_export_decode_different_configs PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestMainFunction::test_main_success PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestMainFunction::test_main_checkpoint_without_config PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestMainFunction::test_main_checkpoint_not_found PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestModelConfigurations::test_prefill_wrapper_different_batch_sizes PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestModelConfigurations::test_decode_wrapper_different_kv_configs PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportEdgeCases::test_export_prefill_minimal_config PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportEdgeCases::test_export_decode_minimal_config PASSED [  2%]
tests/conversion/test_export_pytorch.py::TestExportEdgeCases::test_wrapper_parameter_validation PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_success PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_onnx_file_not_found PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_conversion_failure_without_placeholder PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_conversion_failure_with_placeholder PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_placeholder_created PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_import_failure PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_default_output_path PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_custom_compute_units PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_custom_target PASSED [  2%]
tests/conversion/test_judge_export_coreml.py::TestJudgeExportCoreML::test_main_success_message PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestLoadJudgeConfig::test_load_judge_config_success PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestLoadJudgeConfig::test_load_judge_config_with_defaults PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestLoadJudgeConfig::test_load_judge_config_file_not_found PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestLoadJudgeConfig::test_load_judge_config_no_yaml PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestLoadJudgeConfig::test_load_judge_config_empty_arch PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_success PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_default_configs PASSED [  2%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_shape_sets_fallback PASSED [  3%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_config_loading_error PASSED [  3%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_model_creation PASSED [  3%]
tests/conversion/test_judge_export_onnx.py::TestJudgeExportONNX::test_main_export_paths PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestRMSNorm::test_rmsnorm_forward PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestRMSNorm::test_rmsnorm_eps PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestRMSNorm::test_rmsnorm_weight PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestSwiGLU::test_swiglu_forward PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestSwiGLU::test_swiglu_dimensions PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMultiHeadAttention::test_mha_forward PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMultiHeadAttention::test_mha_different_configs PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMultiHeadAttention::test_mha_d_head_calculation PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestTransformerBlock::test_transformer_block_forward PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestTransformerBlock::test_transformer_block_residual PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestTransformerBlock::test_transformer_block_mlp_hidden_mult PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMainFunction::test_main_success PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMainFunction::test_main_default_args PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMainFunction::test_main_custom_args PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMainFunction::test_main_trace_failure PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestMainFunction::test_main_model_eval_mode PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestIntegration::test_full_block_creation PASSED [  3%]
tests/conversion/test_make_toy_block.py::TestIntegration::test_block_components PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_main_success PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_main_default_args PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_main_custom_args PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_model_structure PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_initializers PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_opset_version PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_graph_connectivity PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_different_sizes PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_output_directory_creation PASSED [  3%]
tests/conversion/test_make_toy_onnx.py::TestMakeToyONNX::test_onnx_model_validity PASSED [  3%]
tests/conversion/test_make_toy_torch.py::TestRMSNorm::test_rmsnorm_forward PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestRMSNorm::test_rmsnorm_eps PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestSwiGLU::test_swiglu_forward PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestSwiGLU::test_swiglu_silu_activation PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestToyTransformer::test_toy_transformer_forward PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestToyTransformer::test_toy_transformer_components PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestToyTransformer::test_toy_transformer_different_sizes PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestToyTransformer::test_toy_transformer_forward_flow PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_success PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_default_args PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_custom_args PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_trace_failure PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_model_eval_mode PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestMainFunction::test_main_input_dtype PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestIntegration::test_full_model_creation PASSED [  4%]
tests/conversion/test_make_toy_torch.py::TestIntegration::test_model_components_work_together PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceInputDtype::test_force_input_dtype_success PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceInputDtype::test_force_input_dtype_not_found PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceInputDtype::test_force_input_dtype_multiple_inputs PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceOutputDtype::test_force_output_dtype_success PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceOutputDtype::test_force_output_dtype_not_found PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestForceOutputDtype::test_force_output_dtype_multiple_outputs PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestStripRedundantCasts::test_strip_redundant_casts_no_casts PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestStripRedundantCasts::test_strip_redundant_casts_redundant_cast SKIPPED [  4%]
tests/conversion/test_onnx_surgery.py::TestStripRedundantCasts::test_strip_redundant_casts_inference_failure PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestStripRedundantCasts::test_strip_redundant_casts_with_cast_nodes PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestCastInt64Initializers::test_cast_int64_initializers_no_initializers PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestCastInt64Initializers::test_cast_int64_initializers_int64_present PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestCastInt64Initializers::test_cast_int64_initializers_mixed_types PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestCastInt64Initializers::test_cast_int64_initializers_no_int64 PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestRunFunction::test_run_success_without_simplification PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestRunFunction::test_run_success_with_simplification PASSED [  4%]
tests/conversion/test_onnx_surgery.py::TestRunFunction::test_run_load_failure PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestRunFunction::test_run_processing_failure PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestMainFunction::test_main_success PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestMainFunction::test_main_run_failure PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestMainFunction::test_main_missing_required_args PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_complete_surgery_workflow PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_dtype_forcing_integration PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_surgery_error_handling PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_simplification_availability PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_shape_inference_fallback PASSED [  5%]
tests/conversion/test_onnx_surgery.py::TestONNXSurgeryIntegration::test_initializer_casting_edge_cases PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_success PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_tuple_output PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_shape_mismatch PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_nan_values PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_inf_values PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_runtime_error PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateShapeWithModel::test_validate_shape_with_model_unexpected_error PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateEnumeratedShapes::test_validate_enumerated_shapes_success PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateEnumeratedShapes::test_validate_enumerated_shapes_default_primary PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateEnumeratedShapes::test_validate_enumerated_shapes_empty_shapes PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateEnumeratedShapes::test_validate_enumerated_shapes_primary_not_in_shapes PASSED [  5%]
tests/conversion/test_shape_validator.py::TestValidateEnumeratedShapes::test_validate_enumerated_shapes_partial_failure PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetProductionShapes::test_get_production_shapes PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetToyShapes::test_get_toy_shapes PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_toy_with_128 PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_toy_without_128 PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_production_with_1024 PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_production_without_1024 PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_empty_shapes_toy PASSED [  5%]
tests/conversion/test_shape_validator.py::TestGetPrimaryShape::test_get_primary_shape_empty_shapes_production PASSED [  5%]
tests/conversion/test_shape_validator.py::TestCheckShapeValidationResults::test_check_shape_validation_results_all_success PASSED [  5%]
tests/conversion/test_shape_validator.py::TestCheckShapeValidationResults::test_check_shape_validation_results_primary_failure PASSED [  6%]
tests/conversion/test_shape_validator.py::TestCheckShapeValidationResults::test_check_shape_validation_results_require_all_failure PASSED [  6%]
tests/conversion/test_shape_validator.py::TestCheckShapeValidationResults::test_check_shape_validation_results_require_all_success PASSED [  6%]
tests/conversion/test_shape_validator.py::TestCheckShapeValidationResults::test_check_shape_validation_results_no_results PASSED [  6%]
tests/e2e/test_8_ball_pipeline.py::test_8_ball_pipeline_e2e PASSED       [  6%]
tests/e2e/test_code_mode.py::TestCodeModeLargeBlob::test_large_blob_requires_code_mode PASSED [  6%]
tests/e2e/test_code_mode.py::TestCodeModeMultiTool::test_multi_tool_requires_code_mode PASSED [  6%]
tests/e2e/test_code_mode.py::TestCodeModePII::test_pii_requires_code_mode PASSED [  6%]
tests/e2e/test_code_mode.py::TestCodeModeTokenEfficiency::test_code_mode_reduces_tokens PASSED [  6%]
tests/e2e/test_code_mode.py::TestCodeModeExecutionCorrectness::test_execution_correctness_gate PASSED [  6%]
tests/e2e/test_code_mode.py::TestCodeModeSingleToolExemption::test_single_tool_not_penalized PASSED [  6%]
tests/e2e/test_code_mode.py::test_single_small_tool_exempt PASSED        [  6%]
tests/e2e/test_code_mode.py::test_adversarial_printing PASSED            [  6%]
tests/e2e/test_code_mode.py::test_pii_binding_path_no_leak PASSED        [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_training_with_latent_curriculum PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_inference_with_latent_spans PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_caws_budget_enforcement PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_latent_spans_respect_caws_tier PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_toy_halt_head_integration PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_toy_training_inference_loop_mismatch PASSED [  6%]
tests/e2e/test_latent_reasoning.py::TestLatentReasoningE2E::test_toy_progressive_curriculum PASSED [  6%]
tests/e2e/test_production_pipeline.py::test_production_pipeline_e2e SKIPPED [  6%]
tests/e2e/test_production_pipeline.py::test_production_pipeline_template PASSED [  6%]
tests/e2e/test_production_shapes.py::test_production_shapes_validation SKIPPED [  6%]
tests/e2e/test_production_shapes.py::test_production_shapes_configuration PASSED [  6%]
tests/e2e/test_production_shapes.py::test_shape_validator_helpers PASSED [  6%]
tests/e2e/test_production_shapes.py::test_production_shape_values[512] PASSED [  6%]
tests/e2e/test_production_shapes.py::test_production_shape_values[1024] PASSED [  6%]
tests/e2e/test_production_shapes.py::test_production_shape_values[2048] PASSED [  6%]
tests/e2e/test_production_shapes.py::test_production_shape_values[4096] PASSED [  6%]
tests/e2e/test_production_shapes.py::test_shape_validation_error_handling PASSED [  6%]
tests/e2e/test_token_reduction.py::TestTokenReductionE2E::test_baseline_direct_cot PASSED [  6%]
tests/e2e/test_token_reduction.py::TestTokenReductionE2E::test_latent_mode_token_reduction PASSED [  7%]
tests/e2e/test_token_reduction.py::TestTokenReductionE2E::test_token_reduction_at_equal_accuracy PASSED [  7%]
tests/e2e/test_token_reduction.py::TestTokenReductionE2E::test_efficiency_curves PASSED [  7%]
tests/e2e/test_toy_ces_measurement.py::TestCESMeasurement::test_ces_baseline_vs_code_mode PASSED [  7%]
tests/e2e/test_toy_ces_measurement.py::TestCESMeasurement::test_ces_baseline_vs_latent PASSED [  7%]
tests/e2e/test_toy_ces_measurement.py::TestCESMeasurement::test_ces_combined_milestones SKIPPED [  7%]
tests/e2e/test_toy_ces_measurement.py::TestCESMeasurement::test_ces_non_eligible_scenario PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_training_without_code_mode PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_training_with_code_mode_disabled PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_training_with_code_mode_enabled PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_training_env_var_doesnt_break PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_code_mode_with_span_targets PASSED [  7%]
tests/e2e/test_toy_code_mode.py::test_toy_code_mode_weight_scheduler_integration PASSED [  7%]
tests/e2e/test_toy_combined_milestones.py::TestCombinedMilestones::test_training_with_both_features PASSED [  7%]
tests/e2e/test_toy_combined_milestones.py::TestCombinedMilestones::test_code_mode_with_latent_spans PASSED [  7%]
tests/e2e/test_toy_combined_milestones.py::TestCombinedMilestones::test_caws_budget_with_code_mode PASSED [  7%]
tests/e2e/test_toy_combined_milestones.py::TestCombinedMilestones::test_mixed_batch_eligibility PASSED [  7%]
tests/e2e/test_toy_combined_milestones.py::TestCombinedMilestones::test_full_pipeline_integration PASSED [  7%]
tests/e2e/test_toy_pipeline.py::test_toy_pipeline_e2e SKIPPED (Verif...) [  7%]
tests/e2e/test_toy_pipeline.py::test_toy_pipeline_with_code_mode PASSED  [  7%]
tests/e2e/test_toy_pipeline.py::test_toy_pipeline_with_latent_mode PASSED [  7%]
tests/e2e/test_toy_pipeline.py::test_toy_pipeline_with_both_features PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestEightBallConstants::test_eight_ball_answers_count PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestEightBallConstants::test_eight_ball_answers_content PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestEightBallConstants::test_eight_ball_token_ids_range PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestEightBallConstants::test_id_to_answer_mapping PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestEightBallConstants::test_id_to_answer_coverage PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestDataClasses::test_prediction_result_creation PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestDataClasses::test_evaluation_metrics_creation PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestLoadEvalQuestions::test_load_eval_questions_json_file PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestLoadEvalQuestions::test_load_eval_questions_text_file PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestLoadEvalQuestions::test_load_eval_questions_nonexistent_file PASSED [  7%]
tests/evaluation/test_8ball_eval.py::TestLoadEvalQuestions::test_load_eval_questions_invalid_json PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_success PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_empty_questions PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_tokenizer_failure PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_with_tokenizer_path PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_import_error PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_mock_path_handling PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_success PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_file_not_found PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_with_tokenizer_path PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_import_error PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_exception_handling PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_success PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_subprocess_failure PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_invalid_json PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_timeout PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_json_with_response_key PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_finds_token_in_output PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_fallback_to_default_token PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_empty_questions PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_identical PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_different PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_empty_lists PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_different_lengths PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_token_distribution PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_with_probabilities PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_probability_drift_different_predictions PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_without_probabilities PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_with_class_id_only PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_token_distribution_calculation PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_answer_distribution PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestComparePredictions::test_compare_predictions_token_out_of_range PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_pytorch_evaluation PASSED [  8%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_coreml_evaluation PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_ollama_evaluation PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_invalid_backend PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_missing_eval_file PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_with_output_file PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_with_reference_comparison PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_load_questions_error PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestMainFunction::test_main_no_eval_file_specified PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_eight_ball_answer_consistency PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_prediction_result_validation PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_metrics_calculation PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_workflow PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_prediction_result_post_init_with_class_id_only PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_prediction_result_post_init_with_token_only PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_prediction_result_post_init_invalid_token PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_prediction_result_with_class_probabilities PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_metrics_post_init_with_legacy_fields PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_metrics_post_init_with_new_fields PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_metrics_post_init_calculated_accuracy PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_evaluation_metrics_post_init_zero_questions PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_list_input PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_dict_with_questions_key PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_json_decode_error_on_json_file PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_text_file_with_empty_lines PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_invalid_type PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEightBallIntegration::test_load_eval_questions_value_error_fallback PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEvaluatePyTorchModelEdgeCases::test_evaluate_pytorch_model_missing_questions_argument PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestEvaluateCoreMLModelEdgeCases::test_evaluate_coreml_model_missing_questions_argument PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestComparePredictionsEdgeCases::test_compare_predictions_empty_lists_detailed PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestComparePredictionsEdgeCases::test_compare_predictions_token_index_bounds PASSED [  9%]
tests/evaluation/test_8ball_eval.py::TestComparePredictionsEdgeCases::test_compare_predictions_with_none_answer PASSED [  9%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_within_limits PASSED [  9%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_exceeds_loc_limit PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_exceeds_files_limit PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_empty_diff PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_multiple_files PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_binary_files PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateBudgetAdherence::test_validate_budget_adherence_edge_cases PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateGateIntegrity::test_validate_gate_integrity_all_pass PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateGateIntegrity::test_validate_gate_integrity_tests_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateGateIntegrity::test_validate_gate_integrity_lint_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateGateIntegrity::test_validate_gate_integrity_coverage_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateGateIntegrity::test_validate_gate_integrity_missing_fields PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateProvenanceClarity::test_validate_provenance_clarity_complete PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateProvenanceClarity::test_validate_provenance_clarity_missing_rationale PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateProvenanceClarity::test_validate_provenance_clarity_missing_evidence PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateProvenanceClarity::test_validate_provenance_clarity_no_diff PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestValidateProvenanceClarity::test_validate_provenance_clarity_whitespace_only PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestEvaluateCawsCompliance::test_evaluate_caws_compliance_all_pass PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestEvaluateCawsCompliance::test_evaluate_caws_compliance_gates_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestEvaluateCawsCompliance::test_evaluate_caws_compliance_provenance_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestEvaluateCawsCompliance::test_evaluate_caws_compliance_budget_fail PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestEvaluateCawsCompliance::test_evaluate_caws_compliance_multiple_failures PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_working_spec_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_working_spec_not_found PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_file_content_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_file_content_not_found PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_json_file_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_json_file_invalid_json PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_tests_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_tests_failure PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_linter_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_coverage_success PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_tests_timeout PASSED [ 10%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_tests_file_not_found PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_tests_text_parsing PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_linter_timeout PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_linter_no_linter_found PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_linter_text_parsing PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_coverage_timeout PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_coverage_file_not_found PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_run_coverage_json_file_parsing PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_file_content_empty_path PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_file_content_invalid_path PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_json_file_empty_path PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_load_json_file_invalid_path PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_evaluate_caws_compliance_with_evidence_string PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_evaluate_caws_compliance_with_evidence_json_string PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestHelperFunctions::test_evaluate_caws_compliance_with_diff_present PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestMainFunction::test_main_success PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestMainFunction::test_main_missing_spec PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestMainFunction::test_main_test_failure PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_complete_caws_evaluation_workflow PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_caws_evaluation_with_violations PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_budget_adherence_edge_cases PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_gate_integrity_thresholds PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_provenance_clarity_validation PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_inferred_removals_special_case PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_inferred_additions_special_case PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_net_change_mismatch PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_multiple_hunks PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_file_path_extraction PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_budget_adherence_dev_null_ignored PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_gate_integrity_all_passed_field PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_gate_integrity_custom_coverage_threshold PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_gate_integrity_no_passed_tests PASSED [ 11%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_provenance_clarity_none_values PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_validate_provenance_clarity_long_inputs PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_evaluate_caws_compliance_partial_failure PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_run_tests_invalid_json PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_run_linter_exception PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_run_coverage_no_output PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_load_json_file_not_found PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_load_file_content_empty_file PASSED [ 12%]
tests/evaluation/test_caws_eval.py::TestCawsEvalIntegration::test_load_working_spec_yaml_error PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResult::test_claim_extraction_eval_result_creation PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResult::test_claim_extraction_eval_result_default_values PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResult::test_claim_extraction_eval_result_calculated_fields PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluator_initialization_with_extractor PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluator_initialization_default PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_success PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_empty_outputs PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_single_output PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_mismatched_lengths PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_with_none_outputs PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluator::test_evaluate_extractor_failure PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionMetricsIntegration::test_complete_evaluation_workflow PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionMetricsIntegration::test_evaluation_with_realistic_outputs PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionMetricsIntegration::test_metrics_calculation_edge_cases PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionMetricsIntegration::test_evaluator_reuse PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionMetricsIntegration::test_evaluator_with_different_extractors PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestFormatResults::test_format_results_basic PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestFormatResults::test_format_results_zero_values PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDataset::test_evaluate_from_dataset_basic PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDataset::test_evaluate_from_dataset_with_max_samples PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_verifiable_content PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_unverifiable_content PASSED [ 12%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_empty_text PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_code_blocks PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_json_content PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_urls PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_with_real_extractor_dates PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestRealClaimExtraction::test_evaluator_loss_calculation_with_real_extractor PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestComputeClaimExtractionMetricsReal::test_compute_claim_extraction_metrics_real_extractor PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestComputeClaimExtractionMetricsReal::test_compute_claim_extraction_metrics_empty_text PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestComputeClaimExtractionMetricsReal::test_compute_claim_extraction_metrics_none_extractor PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestFormatResultsReal::test_format_results_real_data PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestFormatResultsReal::test_format_results_zero_values PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestFormatResultsReal::test_format_results_high_values PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_with_special_characters PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_with_unicode PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_with_newlines PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_ratio_calculation_edge_cases PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_with_multiple_samples_real PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_loss_thresholds PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_ratio_rounding PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_averaging_behavior PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_zero_teacher_claims PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_zero_student_claims PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_both_zero_claims PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_loss_penalty_calculation PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_single_sample PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_large_batch PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_default_extractor_creation PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_custom_extractor PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEdgeCasesReal::test_evaluator_min_thresholds_parameters PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_basic_flow PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_max_samples PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_empty_dataset PASSED [ 13%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_list_teacher_text PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_empty_list_teacher_text PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_missing_teacher_text PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_missing_attention_mask PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestEvaluateFromDatasetReal::test_evaluate_from_dataset_max_samples_exceeds_dataset_size PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestLossCalculationEdgeCases::test_loss_calculation_zero_ratios PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestLossCalculationEdgeCases::test_loss_calculation_meets_thresholds PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestLossCalculationEdgeCases::test_loss_calculation_below_thresholds PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestLossCalculationEdgeCases::test_loss_calculation_penalty_weights PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestLossCalculationEdgeCases::test_loss_calculation_boundary_values PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluatorInitialization::test_evaluator_init_none_extractor PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluatorInitialization::test_evaluator_init_default_extractor PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvaluatorInitialization::test_evaluator_init_custom_extractor PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResultEdgeCases::test_eval_result_negative_values PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResultEdgeCases::test_eval_result_high_values PASSED [ 14%]
tests/evaluation/test_claim_extraction_metrics.py::TestClaimExtractionEvalResultEdgeCases::test_eval_result_fractional_counts PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestClassificationConfig::test_classification_config_creation PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestClassificationConfig::test_classification_config_validation PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestPredictionResult::test_prediction_result_creation PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestPredictionResult::test_prediction_result_without_probabilities PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluationMetrics::test_evaluation_metrics_creation PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluationMetrics::test_evaluation_metrics_minimal PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfig::test_load_classification_config_success PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfig::test_load_classification_config_file_not_found PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfig::test_load_classification_config_invalid_json PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfig::test_load_classification_config_missing_fields PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_success PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_empty_questions PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModel::test_evaluate_pytorch_model_tokenizer_failure PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_success PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluateCoreMLModel::test_evaluate_coreml_model_file_not_found PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_success PASSED [ 14%]
tests/evaluation/test_classification_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_subprocess_failure PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestEvaluateOllamaModel::test_evaluate_ollama_model_invalid_json PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_identical PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_different PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_empty_lists PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_different_lengths PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_with_probabilities PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestComparePredictions::test_compare_predictions_without_probabilities PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestMainFunction::test_main_pytorch_evaluation PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestMainFunction::test_main_coreml_evaluation PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestMainFunction::test_main_invalid_backend PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestMainFunction::test_main_config_not_found PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_complete_evaluation_workflow PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluation_metrics_calculation PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_config_validation PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_prediction_result_validation PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_load_classification_config_module_path PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_load_classification_config_invalid_module_path PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_load_classification_config_module_not_found PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_load_classification_config_yaml_file PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_load_classification_config_yaml_not_installed PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_pytorch_model_with_tokenizer_path PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_pytorch_model_model_load_failure PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_coreml_model_tokenizer_load_failure PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_coreml_model_exception_handling PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_ollama_model_empty_questions PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_evaluate_ollama_model_timeout PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_compare_predictions_kl_divergence PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_compare_predictions_per_class_accuracy PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestClassificationEvalIntegration::test_compare_predictions_prediction_confidence PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfigEdgeCases::test_load_classification_config_empty_path PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfigEdgeCases::test_load_classification_config_invalid_module_path_format PASSED [ 15%]
tests/evaluation/test_classification_eval.py::TestLoadClassificationConfigEdgeCases::test_load_classification_config_module_not_found_import_error PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModelEdgeCases::test_evaluate_pytorch_model_missing_config_argument PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModelEdgeCases::test_evaluate_pytorch_model_missing_config_with_tokenizer PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestEvaluatePyTorchModelEdgeCases::test_evaluate_pytorch_model_empty_questions_returns_empty PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestEvaluateCoreMLModelEdgeCases::test_evaluate_coreml_model_missing_config_argument PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestEvaluateCoreMLModelEdgeCases::test_evaluate_coreml_model_empty_questions_returns_empty PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_compare_predictions_empty_lists_detailed PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_classification_config_inconsistent_mappings PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_main_with_reference_comparison PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_main_load_config_error PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_prediction_result_probabilities_normalization PASSED [ 16%]
tests/evaluation/test_classification_eval.py::TestComparePredictionsEdgeCases::test_evaluation_metrics_all_fields PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestLoadEvalQuestions::test_load_eval_questions_from_json_file PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestLoadEvalQuestions::test_load_eval_questions_from_list_json PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_with_pytorch_only PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_with_pytorch_and_coreml PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_with_pytorch_and_ollama PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_with_temp_output_dir PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_saves_pytorch_predictions PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestMainFunction::test_main_saves_comparison_metrics PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestOutputDirectoryHandling::test_main_creates_temp_dir_when_not_provided PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestOutputDirectoryHandling::test_main_creates_provided_output_dir PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestErrorHandling::test_main_handles_missing_questions_file PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestErrorHandling::test_main_handles_model_evaluation_error PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestFileOutputFormat::test_main_outputs_correct_json_format PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestComparisonMetrics::test_main_calculates_comparison_metrics PASSED [ 16%]
tests/evaluation/test_compare_8ball_pipelines.py::TestComparisonMetrics::test_main_handles_missing_probabilities_for_ollama PASSED [ 16%]
tests/evaluation/test_evaluation_init.py::TestEvaluationInit::test_evaluation_module_import PASSED [ 16%]
tests/evaluation/test_evaluation_init.py::TestEvaluationInit::test_eightball_eval_import_alias PASSED [ 16%]
tests/evaluation/test_evaluation_init.py::TestEvaluationInit::test_evaluation_module_has_eightball_eval PASSED [ 16%]
tests/evaluation/test_long_ctx_eval.py::TestLongCtxEval::test_main_function PASSED [ 16%]
tests/evaluation/test_long_ctx_eval.py::TestLongCtxEval::test_main_function_no_exception PASSED [ 16%]
tests/evaluation/test_perf_mem_eval.py::TestHardwareInfo::test_hardware_info_creation PASSED [ 16%]
tests/evaluation/test_perf_mem_eval.py::TestHardwareInfo::test_hardware_info_default_export_path PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestDetectHardware::test_detect_hardware_macos PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestDetectHardware::test_detect_hardware_non_macos PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestDetectHardware::test_detect_hardware_no_coremltools PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestDetectHardware::test_detect_hardware_sysctl_failure PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestStepAdapter::test_step_adapter_abstract_methods PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestStepAdapter::test_step_adapter_subclass_implementation PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestGreedyArgmax::test_greedy_argmax_single_max PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestGreedyArgmax::test_greedy_argmax_multiple_same PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestGreedyArgmax::test_greedy_argmax_single_element PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestGreedyArgmax::test_greedy_argmax_negative_values PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestGreedyArgmax::test_greedy_argmax_empty_array PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_valid_simple PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_valid_complex PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_invalid_missing_braces PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_empty_json PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_missing_colon PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_empty_string PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_not_dict PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_name_not_string PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestIsValidToolJSON::test_is_valid_tool_json_arguments_not_dict PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_no_coremltools PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_standard_path PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_with_tokenizer PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_split_ttft PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_with_prompt_cache PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_with_speculative_decoder PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_with_kv_cache PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestRunCoreMLSpeed::test_run_coreml_speed_with_batch_policy PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_file_not_found PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_jsonl_format PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_with_input_dict PASSED [ 17%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_return_texts PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_max_samples PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_optimized_tokenizer PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestLoadTokenizedPrompts::test_load_tokenized_prompts_tokenizer_failure PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestMainFunction::test_main_success PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestMainFunction::test_main_missing_required_args PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestPerfMemEvalIntegration::test_hardware_detection_integration PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestPerfMemEvalIntegration::test_greedy_argmax_properties PASSED [ 18%]
tests/evaluation/test_perf_mem_eval.py::TestPerfMemEvalIntegration::test_json_validation_comprehensive PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestModelRole::test_model_role_values PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestModelRole::test_model_role_count PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceTargets::test_performance_targets_creation PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceTargetsConstants::test_performance_targets_all_roles PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceTargetsConstants::test_worker_targets PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceTargetsConstants::test_judge_targets PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceTargetsConstants::test_drafter_targets PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceMetrics::test_performance_metrics_creation PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceMetrics::test_performance_metrics_optional_fields PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmark::test_benchmark_initialization_worker PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmark::test_benchmark_initialization_judge PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmark::test_benchmark_initialization_drafter PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateLatency::test_evaluate_latency_empty_list PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateLatency::test_evaluate_latency_single_measurement PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateLatency::test_evaluate_latency_multiple_measurements PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateLatency::test_evaluate_latency_exceeds_target PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateLatency::test_evaluate_latency_worker_targets PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateThroughput::test_evaluate_throughput_passes PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateThroughput::test_evaluate_throughput_fails PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateThroughput::test_evaluate_throughput_worker PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateThroughput::test_evaluate_throughput_drafter PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateQuality::test_evaluate_quality_with_accuracy PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateQuality::test_evaluate_quality_with_confidence PASSED [ 18%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateQuality::test_evaluate_quality_with_both PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateQuality::test_evaluate_quality_fails PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateQuality::test_evaluate_quality_none_values PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateResources::test_evaluate_resources_passes PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateResources::test_evaluate_resources_fails PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateResources::test_evaluate_resources_worker PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAll::test_evaluate_all_with_latencies PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAll::test_evaluate_all_without_latencies PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAll::test_evaluate_all_worker PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAll::test_evaluate_all_drafter PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmarkIntegration::test_complete_benchmark_workflow PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmarkIntegration::test_benchmark_comparison_across_roles PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTime::test_measure_inference_time_basic PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTime::test_measure_inference_time_with_args PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTime::test_measure_inference_time_with_kwargs PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTime::test_measure_inference_time_returns_ms PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_basic PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_fast PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_slow PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_zero_latency PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_negative_latency PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecond::test_calculate_tokens_per_second_very_small_latency PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_with_zero_tokens_per_second PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_without_quality_metrics PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_overall_pass_calculation PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_overall_pass_fails PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_latency_percentile_calculation PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCases::test_evaluate_all_latency_small_list PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_empty_list PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_single_value PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_two_values PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_exactly_at_threshold PASSED [ 19%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_just_below_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_just_above_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_boundary_percentile_calculation PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_large_list PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_unsorted_list PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_duplicate_values PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestLatencyEvaluationEdgeCases::test_evaluate_latency_all_three_roles PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_zero_tokens_per_second PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_exactly_at_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_just_below_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_just_above_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_very_high_value PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestThroughputEvaluationEdgeCases::test_evaluate_throughput_all_three_roles PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_no_metrics PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_only_accuracy PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_only_confidence PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_exactly_at_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_just_below_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_just_above_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_zero_accuracy PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_one_accuracy PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestQualityEvaluationEdgeCases::test_evaluate_quality_all_three_roles PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_zero_memory PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_zero_cpu PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_exactly_at_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_just_below_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_just_above_threshold PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_very_high_values PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestResourceEvaluationEdgeCases::test_evaluate_resources_all_three_roles PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_with_none_latency_ms PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_with_single_latency_measurement PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_overall_pass_with_none_quality PASSED [ 20%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_overall_pass_fails_on_memory PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_overall_pass_fails_on_cpu PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_overall_pass_fails_on_accuracy PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_overall_pass_fails_on_confidence PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestEvaluateAllEdgeCasesExtended::test_evaluate_all_all_three_roles PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_immediate_return PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_with_args PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_with_kwargs PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_with_args_and_kwargs PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_returns_none PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestMeasureInferenceTimeEdgeCases::test_measure_inference_time_raises_exception PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_zero_latency PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_negative_latency PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_zero_tokens PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_normal_case PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_high_throughput PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_low_latency PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_fractional_latency PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestCalculateTokensPerSecondEdgeCases::test_calculate_tokens_per_second_large_tokens PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmarkInitialization::test_performance_benchmark_all_roles PASSED [ 21%]
tests/evaluation/test_performance_benchmarks.py::TestPerformanceBenchmarkInitialization::test_performance_benchmark_targets_access PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_pytorch_only PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_pytorch_and_coreml_comparison PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_pytorch_and_ollama_comparison PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_all_backends_comparison PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_config_load_error PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_with_eval_questions_file PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_with_default_questions_from_module PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_fallback_to_default_questions PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_output_dir_creation PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_saves_pytorch_predictions PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_saves_comparison_metrics PASSED [ 21%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalMain::test_main_handles_none_probabilities PASSED [ 22%]
tests/evaluation/test_pipeline_preservation_eval.py::TestPipelinePreservationEvalIntegration::test_pipeline_comparison_workflow PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestLoadModel::test_load_model_with_config PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestLoadModel::test_load_model_without_config PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestLoadModel::test_load_model_checkpoint_without_state_dict PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGenerateText::test_generate_text_basic PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGenerateText::test_generate_text_with_eos PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGenerateText::test_generate_text_device_detection PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGenerateText::test_generate_text_removes_prompt PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGenerateText::test_generate_text_default_max_tokens PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGetReasoningPrompts::test_get_reasoning_prompts_returns_list PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGetReasoningPrompts::test_get_reasoning_prompts_structure PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGetReasoningPrompts::test_get_reasoning_prompts_categories PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestGetReasoningPrompts::test_get_reasoning_prompts_non_empty PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_success PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_empty_responses PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_whitespace_only PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_category_stats PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_mixed_validity PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_empty_prompts PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_missing_category PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestEvaluateReasoning::test_evaluate_reasoning_results_structure PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestMainFunction::test_main_success PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestMainFunction::test_main_with_test_data PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestMainFunction::test_main_tokenizer_load_failure PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestMainFunction::test_main_output_file_creation PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestReasoningEvalIntegration::test_complete_reasoning_evaluation_workflow PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestReasoningEvalIntegration::test_load_model_checkpoint_not_found PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestReasoningEvalIntegration::test_get_reasoning_prompts_defaults PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestReasoningEvalIntegration::test_evaluate_reasoning_category_breakdown PASSED [ 22%]
tests/evaluation/test_reasoning_eval.py::TestReasoningEvalIntegration::test_evaluate_reasoning_progress_reporting PASSED [ 22%]
tests/evaluation/test_tool_use_eval.py::TestLoadModel::test_load_model_with_config PASSED [ 22%]
tests/evaluation/test_tool_use_eval.py::TestLoadModel::test_load_model_without_config PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestLoadModel::test_load_model_checkpoint_not_found PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestGenerateText::test_generate_text_basic PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestGenerateText::test_generate_text_with_eos PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestGenerateText::test_generate_text_temperature PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestGenerateText::test_generate_text_max_length PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_valid_simple PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_valid_complex PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_invalid_syntax PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_empty_string PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_whitespace_only PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_non_json_text PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestValidateJSON::test_validate_json_partial_json PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_valid_json PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_nested_structure PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_invalid_json PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_no_tool_call PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_empty_json PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_malformed_tool_call PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestExtractToolCall::test_extract_tool_call_multiple_tools PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestEvaluateToolUse::test_evaluate_tool_use_success PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestEvaluateToolUse::test_evaluate_tool_use_invalid_json PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestEvaluateToolUse::test_evaluate_tool_use_wrong_tool PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestEvaluateToolUse::test_evaluate_tool_use_model_load_failure PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestEvaluateToolUse::test_evaluate_tool_use_empty_test_cases PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestMainFunction::test_main_success PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestMainFunction::test_main_checkpoint_not_found PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestMainFunction::test_main_config_not_found PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_json_validation_edge_cases PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_tool_call_extraction_variations PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_complete_evaluation_workflow PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluation_metrics_calculation PASSED [ 23%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_error_handling_robustness PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_load_model_checkpoint_without_state_dict PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_load_model_mock_path PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_tokenizer_callable PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_dict_tokenizer_output PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_device_detection PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_default_max_tokens PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_max_length_parameter PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_device_detection_fallback PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_tokenizer_fallback_to_callable PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_tokenizer_last_resort_dummy PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_model_forward_fallback PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_logits_tuple_output PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_generate_text_logits_shape_fallback PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_extract_tool_call_embedded_json PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_extract_tool_call_tool_call_field PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_extract_tool_call_no_name_field PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_extract_tool_call_incomplete_json PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_keyword_args PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_keyword_args_missing_params PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_positional_args_model_tokenizer PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_invalid_positional_args PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_json_repair_needed PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_args_comparison PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_wrong_args PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_evaluate_tool_use_checkpoint_path_tokenizer_failure PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_main_with_output_file PASSED [ 24%]
tests/evaluation/test_tool_use_eval.py::TestToolUseEvalIntegration::test_extract_tool_call_tool_calls_array PASSED [ 24%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConstants::test_binary_answers_count PASSED [ 24%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConstants::test_binary_token_range PASSED [ 24%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConstants::test_id_to_binary_answer_mapping PASSED [ 24%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConstants::test_binary_answer_to_id_mapping PASSED [ 24%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConstants::test_mapping_consistency PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConfig::test_binary_classifier_config_creation PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierConfig::test_binary_classifier_config_mappings PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestLoadBinaryEvalQuestions::test_load_binary_eval_questions_existing_file PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestLoadBinaryEvalQuestions::test_load_binary_eval_questions_nonexistent_file PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestLoadBinaryEvalQuestions::test_load_binary_eval_questions_default_questions_format PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestLoadBinaryEvalQuestions::test_load_binary_eval_questions_empty_questions PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestGetBinaryQuestions::test_get_binary_questions_custom_path PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestGetBinaryQuestions::test_get_binary_questions_creates_default PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierIntegration::test_complete_workflow PASSED [ 25%]
tests/evaluation/test_toy_binary_classifier.py::TestBinaryClassifierIntegration::test_answer_consistency PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_normal_values PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_contains_nan PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_all_zero PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_very_small_values PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_mixed_zero_and_nan PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_empty_list PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestHasNanOrZero::test_has_nan_or_zero_single_value PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_perfect_match PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_no_matches PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_partial_matches PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_meaningful_tokens PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_tool_tokens_present PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_empty_samples PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_missing_target PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestMicroF1::test_micro_f1_missing_pred PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeLogits::test_greedy_decode_logits_basic PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeLogits::test_greedy_decode_logits_unknown_id PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeLogits::test_greedy_decode_logits_multiple_max PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeSequence::test_greedy_decode_sequence_2d PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeSequence::test_greedy_decode_sequence_3d_single_batch PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeSequence::test_greedy_decode_sequence_3d_multi_batch PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeSequence::test_greedy_decode_sequence_max_steps PASSED [ 25%]
tests/evaluation/test_toy_contracts.py::TestGreedyDecodeSequence::test_greedy_decode_sequence_unknown_tokens PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestLoadCoreMLModel::test_load_coreml_model_success PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestLoadCoreMLModel::test_load_coreml_model_not_available PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestMainFunction::test_main_success PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestMainFunction::test_main_coreml_not_available PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestMainFunction::test_main_numpy_not_available PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestMainFunction::test_main_model_load_failure PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestMainFunction::test_main_with_id2tok_file PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestToyContractsIntegration::test_has_nan_or_zero_integration PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestToyContractsIntegration::test_micro_f1_with_tool_spans PASSED [ 26%]
tests/evaluation/test_toy_contracts.py::TestToyContractsIntegration::test_greedy_decode_full_workflow PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_eight_ball_answers_count PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_eight_ball_token_range PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_id_to_answer_mapping PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_answer_to_id_mapping PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_mapping_consistency PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallConstants::test_all_answers_unique PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestClassificationConfig::test_eight_ball_config_creation PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestClassificationConfig::test_eight_ball_config_mappings PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestClassificationConfig::test_classification_config_creation PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestLoadEvalQuestions::test_load_eval_questions_existing_file PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestLoadEvalQuestions::test_load_eval_questions_nonexistent_file PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestLoadEvalQuestions::test_load_eval_questions_empty_questions PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestLoadEvalQuestions::test_load_eval_questions_missing_questions_key PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestGetEightBallQuestions::test_get_eight_ball_questions_default PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestGetEightBallQuestions::test_get_eight_ball_questions_custom_path PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestGetEightBallQuestions::test_get_eight_ball_questions_creates_default PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallIntegration::test_complete_workflow PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallIntegration::test_answer_consistency PASSED [ 26%]
tests/evaluation/test_toy_eight_ball.py::TestEightBallIntegration::test_token_ids_sequential PASSED [ 26%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConstants::test_ternary_answers_count PASSED [ 26%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConstants::test_ternary_token_range PASSED [ 26%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConstants::test_id_to_ternary_answer_mapping PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConstants::test_ternary_answer_to_id_mapping PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConstants::test_mapping_consistency PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConfig::test_ternary_classifier_config_creation PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierConfig::test_ternary_classifier_config_mappings PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestLoadTernaryEvalQuestions::test_load_ternary_eval_questions_existing_file PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestLoadTernaryEvalQuestions::test_load_ternary_eval_questions_nonexistent_file PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestLoadTernaryEvalQuestions::test_load_ternary_eval_questions_default_questions_format PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestLoadTernaryEvalQuestions::test_load_ternary_eval_questions_empty_questions PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestGetTernaryQuestions::test_get_ternary_questions_custom_path PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestGetTernaryQuestions::test_get_ternary_questions_creates_default PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierIntegration::test_complete_workflow PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierIntegration::test_answer_consistency PASSED [ 27%]
tests/evaluation/test_toy_ternary_classifier.py::TestTernaryClassifierIntegration::test_uncertain_answer PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_init_no_limit PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_init_with_limit PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_add_sample_api_call PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_add_sample_cached PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_budget_limit_enforcement PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_budget_limit_not_exceeded PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_multiple_samples PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_mixed_cached_and_api_samples PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_get_estimate PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_get_status PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_get_status_no_limit PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetTracker::test_budget_exceeded_exact_limit PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetCostCalculation::test_cost_calculation_api_call PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetCostCalculation::test_cost_calculation_cached PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetCostCalculation::test_cost_calculation_fractional_tokens PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetEstimation::test_estimate_small_dataset PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetEstimation::test_estimate_large_dataset PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetEstimation::test_estimate_custom_token_counts PASSED [ 27%]
tests/integration/test_budget_tracking.py::TestBudgetEstimation::test_estimate_matches_actual_cost PASSED [ 28%]
tests/integration/test_budget_tracking.py::TestBudgetLimitScenarios::test_budget_limit_zero SKIPPED [ 28%]
tests/integration/test_budget_tracking.py::TestBudgetLimitScenarios::test_budget_limit_very_small PASSED [ 28%]
tests/integration/test_budget_tracking.py::TestBudgetLimitScenarios::test_budget_limit_large PASSED [ 28%]
tests/integration/test_budget_tracking.py::TestBudgetLimitScenarios::test_budget_exceeded_after_multiple_samples PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_full_pipeline_small PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_full_pipeline_large PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_pipeline_determinism PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_determinism_full_pipeline PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_pipeline_error_recovery PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_pipeline_performance PASSED [ 28%]
tests/integration/test_contextual_pipeline.py::test_pipeline_memory_usage PASSED [ 28%]
tests/integration/test_performance_contextual.py::test_generation_performance PASSED [ 28%]
tests/integration/test_performance_contextual.py::test_extraction_performance PASSED [ 28%]
tests/integration/test_performance_contextual.py::test_verification_performance PASSED [ 28%]
tests/integration/test_performance_contextual.py::test_memory_usage_large_dataset PASSED [ 28%]
tests/integration/test_process_step_integration.py::test_dataset_loads_process_step_targets PASSED [ 28%]
tests/integration/test_process_step_integration.py::test_batch_contains_process_step_targets PASSED [ 28%]
tests/integration/test_process_step_integration.py::test_process_supervision_loss_with_token_ids PASSED [ 28%]
tests/integration/test_process_step_integration.py::test_training_step_with_process_step_targets PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_init PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_save_checkpoint PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_load_checkpoint PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_load_checkpoint_nonexistent PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_clear_checkpoint PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointManager::test_checkpoint_preserves_results PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestBudgetTrackerCheckpoint::test_budget_state_preserved PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestResumeWorkflow::test_resume_skips_completed_indices PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestResumeWorkflow::test_resume_preserves_budget PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCacheIntegration::test_cache_validation PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCacheIntegration::test_cache_corruption_handling PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointInterval::test_checkpoint_interval_logic PASSED [ 28%]
tests/integration/test_resume_checkpoint.py::TestCheckpointInterval::test_final_checkpoint_always_saved PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestEnumeratedShapeTrainingIntegration::test_shape_sampling_in_training_loop PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestEnumeratedShapeTrainingIntegration::test_multiple_shapes_in_sequence PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestLatencyAwareLossesIntegration::test_length_aware_loss_in_training_step PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestLatencyAwareLossesIntegration::test_early_tool_loss_in_training_step PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestLatencyAwareLossesIntegration::test_latency_losses_with_combined_kd PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestQATIntegration::test_qat_enablement_timing PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestQATIntegration::test_qat_disabled_by_default PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestSpeedMetricsIntegration::test_speed_metrics_with_model PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestSpeedMetricsIntegration::test_speed_metrics_aggregation PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestTrainingStepWithSpeedOptimizations::test_training_step_with_length_loss PASSED [ 29%]
tests/integration/test_speed_optimization_integration.py::TestTrainingStepWithSpeedOptimizations::test_training_step_with_early_tool_loss PASSED [ 29%]
tests/integration/test_training_pipeline.py::TestDatasetModelIntegration::test_dataset_model_forward PASSED [ 29%]
tests/integration/test_training_pipeline.py::TestDatasetModelIntegration::test_dataset_dataloader_model PASSED [ 29%]
tests/integration/test_training_pipeline.py::TestKDTrainingIntegration::test_kd_loss_computation PASSED [ 29%]
tests/integration/test_training_pipeline.py::TestKDTrainingIntegration::test_kd_training_step FAILED [ 29%]
tests/integration/test_training_pipeline.py::TestKDTrainingIntegration::test_checkpoint_save_load PASSED [ 29%]
tests/integration/test_training_pipeline.py::TestProcessSupervisionIntegration::test_process_supervision_loss_with_model PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_halt_head_initialized PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_halt_head_not_initialized PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_forward_returns_halt_logits PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_forward_hidden_processes_without_lm_head PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_halt_head_output_shape PASSED [ 29%]
tests/models/test_halt_head.py::TestHaltHead::test_halt_logits_are_differentiable PASSED [ 29%]
tests/models/test_teacher_client.py::TestAPITier::test_tier_enum_values PASSED [ 29%]
tests/models/test_teacher_client.py::TestAPITier::test_tier_limits_structure PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_http_backend PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_http_endpoint_normalization PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_api_key_from_env PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_hf_backend PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_invalid_backend PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientInitialization::test_init_hf_unavailable PASSED [ 29%]
tests/models/test_teacher_client.py::TestTeacherClientFactoryMethods::test_from_endpoint_basic PASSED [ 30%]
tests/models/test_teacher_client.py::TestTeacherClientFactoryMethods::test_from_endpoint_with_options PASSED [ 30%]
tests/models/test_teacher_client.py::TestTeacherClientFactoryMethods::test_from_hf_basic PASSED [ 30%]
tests/models/test_teacher_client.py::TestTierDetection::test_get_tier PASSED [ 30%]
tests/models/test_teacher_client.py::TestTierDetection::test_get_tier_limits PASSED [ 30%]
tests/models/test_teacher_client.py::TestTierDetection::test_update_tier_from_response_headers PASSED [ 30%]
tests/models/test_teacher_client.py::TestTierDetection::test_update_tier_unknown_header PASSED [ 30%]
tests/models/test_teacher_client.py::TestRetrySession::test_setup_retry_session PASSED [ 30%]
tests/models/test_teacher_client.py::TestRetrySession::test_get_retry_after_header PASSED [ 30%]
tests/models/test_teacher_client.py::TestRetrySession::test_get_retry_after_no_header PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_single_prompt_success PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_with_logits PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_retry_on_failure PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_rate_limit_handling PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_max_retries_exceeded PASSED [ 30%]
tests/models/test_teacher_client.py::TestHTTPBackendSampling::test_sample_multi_prompt_batch PASSED [ 30%]
tests/models/test_teacher_client.py::TestHuggingFaceBackend::test_hf_sample_basic PASSED [ 30%]
tests/models/test_teacher_client.py::TestCircuitBreaker::test_try_fallback_api_success PASSED [ 30%]
tests/models/test_teacher_client.py::TestHealthCheck::test_health_check_success PASSED [ 30%]
tests/models/test_teacher_client.py::TestHealthCheck::test_health_check_failure PASSED [ 30%]
tests/models/test_teacher_client.py::TestMultiStepSampling::test_sample_multi_step_basic PASSED [ 30%]
tests/models/test_teacher_client.py::TestErrorHandling::test_sample_empty_prompts PASSED [ 30%]
tests/models/test_teacher_client.py::TestErrorHandling::test_sample_malformed_response PASSED [ 30%]
tests/models/test_teacher_client.py::TestErrorHandling::test_sample_timeout PASSED [ 30%]
tests/property/test_span_invariants.py::test_span_round_trip_ascii SKIPPED [ 30%]
tests/property/test_span_invariants.py::test_normalization_stability PASSED [ 30%]
tests/property/test_span_invariants.py::test_normalization_crlf_variants PASSED [ 30%]
tests/property/test_span_invariants.py::test_normalization_nfd_nfc_variants PASSED [ 30%]
tests/property/test_span_invariants.py::test_span_round_trip_accented PASSED [ 30%]
tests/property/test_span_invariants.py::test_span_round_trip_emoji PASSED [ 30%]
tests/runtime/test_caws_budget_enforcement.py::TestCAWSBudgetEnforcement::test_tier_1_limits PASSED [ 30%]
tests/runtime/test_caws_budget_enforcement.py::TestCAWSBudgetEnforcement::test_tier_2_limits PASSED [ 30%]
tests/runtime/test_caws_budget_enforcement.py::TestCAWSBudgetEnforcement::test_tier_3_limits PASSED [ 31%]
tests/runtime/test_caws_budget_enforcement.py::TestCAWSBudgetEnforcement::test_budget_breach_forces_halt PASSED [ 31%]
tests/runtime/test_caws_budget_enforcement.py::TestCAWSBudgetEnforcement::test_latent_spans_respect_tier PASSED [ 31%]
tests/runtime/test_generate_coreml.py::TestLoadCoreMLModel::test_load_coreml_model_success PASSED [ 31%]
tests/runtime/test_generate_coreml.py::TestLoadCoreMLModel::test_load_coreml_model_no_coreml PASSED [ 31%]
tests/runtime/test_generate_coreml.py::TestLoadCoreMLModel::test_load_coreml_model_file_error PASSED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateToolCall::test_generate_tool_call_coreml_success FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateToolCall::test_generate_tool_call_pytorch_success FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateToolCall::test_generate_tool_call_no_torch FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateToolCall::test_generate_tool_call_with_halt_logits FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateTextStreaming::test_generate_text_streaming_basic FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateTextStreaming::test_generate_text_streaming_constrained FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestGenerateTextStreaming::test_generate_text_streaming_with_tools FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestMainFunction::test_main_tool_call_mode FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestMainFunction::test_main_text_generation_mode FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestErrorHandling::test_generate_tool_call_model_error FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestErrorHandling::test_generate_text_streaming_tokenizer_error ERROR [ 31%]
tests/runtime/test_generate_coreml.py::TestIntegrationScenarios::test_full_tool_call_workflow FAILED [ 31%]
tests/runtime/test_generate_coreml.py::TestIntegrationScenarios::test_full_text_generation_workflow FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheInit::test_init_numpy_fp16 PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheInit::test_init_torch_fp32 PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheInit::test_init_torch_not_available PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheInit::test_init_invalid_precision PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_update_single_position PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_update_multiple_positions FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_update_out_of_bounds FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_get_slice FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_get_slice_empty_cache PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_get_slice_beyond_current_len FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheOperations::test_reset FAILED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheMemory::test_memory_calculation_fp16 PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheMemory::test_memory_calculation_fp32 PASSED [ 31%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheMemory::test_large_cache_creation PASSED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCachePerformance::test_update_performance ERROR [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCachePerformance::test_slice_performance ERROR [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCachePerformance::test_memory_contiguity FAILED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCachePerformance::test_cache_alignment FAILED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheTorch::test_torch_tensor_operations FAILED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheTorch::test_torch_slice_operations FAILED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheEdgeCases::test_zero_sequence_length PASSED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheEdgeCases::test_single_head PASSED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheEdgeCases::test_large_head_dimension PASSED [ 32%]
tests/runtime/test_kv_cache_optimized.py::TestOptimizedKVCacheEdgeCases::test_update_at_max_capacity FAILED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_bot_token_switches_to_latent_mode PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_eot_token_switches_to_language_mode PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_latent_mode_processes_hidden_state PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_max_latent_length_safety_check PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_unmatched_bot_token_error PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_unmatched_eot_token_error PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_max_latent_spans_limit PASSED [ 32%]
tests/runtime/test_latent_mode.py::TestLatentModeEngine::test_latent_mode_disabled PASSED [ 32%]
tests/runtime/test_latent_smoke.py::TestLatentSmoke::test_smoke_sentinel_parsing PASSED [ 32%]
tests/runtime/test_latent_smoke.py::TestLatentSmoke::test_smoke_multiple_spans PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_should_halt_on_max_loops PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_should_halt_on_judge_score_and_delta_shrinking PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_should_halt_on_halt_head_threshold PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_should_continue_when_conditions_not_met PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_tier_limits_enforced PASSED [ 32%]
tests/runtime/test_refinement_controller.py::TestRefinementController::test_reset_clears_state PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_nested_bot_without_eot PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_unmatched_eot PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_excess_latent_spans PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_max_latent_length_enforcement PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_missing_hidden_state_fallback PASSED [ 32%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_forward_hidden_error_fallback PASSED [ 33%]
tests/runtime/test_safety_edge_cases.py::TestSafetyEdgeCases::test_generation_ends_in_latent_mode PASSED [ 33%]
tests/test_ane_optimizations.py::test_int64_detection_on_attention_paths PASSED [ 33%]
tests/test_ane_optimizations.py::test_embedding_layer_int32_verification PASSED [ 33%]
tests/test_ane_optimizations.py::test_ane_op_compatibility_verification PASSED [ 33%]
tests/test_ane_optimizations.py::test_enumerated_shapes_static_allocation PASSED [ 33%]
tests/test_ane_optimizations.py::test_ane_residency_threshold PASSED     [ 33%]
tests/test_caws_compliance_gates.py::test_privacy_gate_pii_detection PASSED [ 33%]
tests/test_caws_compliance_gates.py::test_control_integration_gate PASSED [ 33%]
tests/test_caws_compliance_gates.py::test_json_validity_gate PASSED      [ 33%]
tests/test_caws_compliance_gates.py::test_fixture_hit_rate_gate PASSED   [ 33%]
tests/test_caws_compliance_gates.py::test_broker_fixtures_hit_rate SKIPPED [ 33%]
tests/test_caws_compliance_gates.py::test_integration_f1_gate PASSED     [ 33%]
tests/test_caws_compliance_gates.py::test_gate_thresholds_documented PASSED [ 33%]
tests/test_claims_pipeline_toy.py::test_stage_1_disambiguation PASSED    [ 33%]
tests/test_claims_pipeline_toy.py::test_stage_2_qualification PASSED     [ 33%]
tests/test_claims_pipeline_toy.py::test_stage_3_decomposition PASSED     [ 33%]
tests/test_claims_pipeline_toy.py::test_stage_4_verification PASSED      [ 33%]
tests/test_claims_pipeline_toy.py::test_full_pipeline_end_to_end PASSED  [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_with_policy_gating PASSED [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_determinism PASSED      [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_error_handling PASSED   [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_coverage_requirements PASSED [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_outcome_distribution PASSED [ 33%]
tests/test_claims_pipeline_toy.py::test_pipeline_fingerprints PASSED     [ 33%]
tests/test_claims_policy.py::test_status_claim_requires_artifacts_short_circuits PASSED [ 33%]
tests/test_claims_policy.py::test_numeric_claim_requires_json_field PASSED [ 33%]
tests/test_claims_policy.py::test_superlative_is_always_blocked PASSED   [ 33%]
tests/test_claims_policy.py::test_claim_with_required_artifacts_passes_policy_gate PASSED [ 33%]
tests/test_claims_policy.py::test_benchmark_claim_requires_bench_json PASSED [ 33%]
tests/test_claims_toy_model_integration.py::test_toy_model_claims_extraction PASSED [ 33%]
tests/test_claims_toy_model_integration.py::test_toy_model_eval_harness_pattern PASSED [ 33%]
tests/test_claims_toy_model_integration.py::test_toy_model_claims_with_policy PASSED [ 33%]
tests/test_claims_toy_model_integration.py::test_toy_model_determinism PASSED [ 34%]
tests/test_claims_toy_model_integration.py::test_toy_model_coverage_scenarios PASSED [ 34%]
tests/test_coreml_golden_vectors.py::test_coreml_golden_vectors SKIPPED  [ 34%]
tests/test_coreml_golden_vectors.py::test_coreml_io_contract SKIPPED     [ 34%]
tests/test_entailment_calibration.py::test_calibration_script_reduces_mean_nll PASSED [ 34%]
tests/test_export_contracts.py::test_export_prefill_model_no_unsupported_ops PASSED [ 34%]
tests/test_export_contracts.py::test_export_model_int32_input_ids PASSED [ 34%]
tests/test_export_contracts.py::test_attention_mask_dtype_consistency PASSED [ 34%]
tests/test_export_contracts.py::test_softmax_inputs_not_int PASSED       [ 34%]
tests/test_performance_regression.py::test_performance_regression_gates SKIPPED [ 34%]
tests/test_performance_regression.py::test_memory_budget_compliance SKIPPED [ 34%]
tests/test_placeholder_detection.py::test_placeholder_marker_detection PASSED [ 34%]
tests/test_placeholder_detection.py::test_production_model_not_placeholder PASSED [ 34%]
tests/test_placeholder_detection.py::test_placeholder_detection_integration PASSED [ 34%]
tests/test_precision_islands.py::test_precision_islands_config_loading PASSED [ 34%]
tests/test_precision_islands.py::test_precision_islands_verification SKIPPED [ 34%]
tests/test_prefill_decode_consistency.py::test_kv_cache_index_advancement PASSED [ 34%]
tests/test_prefill_decode_consistency.py::test_prefill_decode_consistency_pytorch PASSED [ 34%]
tests/test_prefill_decode_consistency.py::test_prefill_decode_consistency_coreml SKIPPED [ 34%]
tests/test_prefill_decode_consistency.py::test_multi_batch_kv_cache_handling PASSED [ 34%]
tests/test_quantization_ab.py::test_quantization_ab_golden_vectors SKIPPED [ 34%]
tests/test_quantization_ab.py::test_quantization_behavioral_correctness SKIPPED [ 34%]
tests/test_quantization_export.py::test_int8_weights_verification SKIPPED [ 34%]
tests/test_quantization_export.py::test_qat_module_folding SKIPPED (...) [ 34%]
tests/test_quantization_export.py::test_quantization_recipe_validation SKIPPED [ 34%]
tests/test_tokenizer_contract.py::test_special_token_ids_match_constants FAILED [ 34%]
tests/test_tokenizer_contract.py::test_special_tokens_are_single_tokens FAILED [ 34%]
tests/test_tokenizer_contract.py::test_round_trip_stability FAILED       [ 34%]
tests/test_tokenizer_contract.py::test_masking_safety PASSED             [ 34%]
tests/test_tokenizer_contract.py::test_loss_masking_never_hides_supervised_tokens PASSED [ 34%]
tests/test_training_reproducibility.py::test_dataset_fingerprint_validation PASSED [ 34%]
tests/test_training_reproducibility.py::test_deterministic_model_initialization PASSED [ 34%]
tests/test_training_reproducibility.py::test_checkpoint_reproducibility PASSED [ 35%]
tests/test_training_reproducibility.py::test_seed_management PASSED      [ 35%]
tests/test_training_reproducibility.py::test_dataset_sharding_determinism PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_1_identical_claim_and_cmax_verified_when_covered PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_2_full_support_including_c_entails_cmax PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_3_right_answer_wrong_rationale_insufficient PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_4_retrieval_mismatch_insufficient PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_5_contradiction_has_precedence_over_support PASSED [ 35%]
tests/test_verification_outcomes.py::test_outcome_6_insufficient_evidence_when_all_below_thresholds PASSED [ 35%]
tests/test_verification_outcomes.py::test_binding_aware_coverage_requires_spo_same_sentence PASSED [ 35%]
tests/test_verification_outcomes.py::test_negation_mismatch_penalizes_coverage_and_blocks_verified PASSED [ 35%]
tests/test_verification_outcomes.py::test_operator_thresholds_and_precedence_included_in_fingerprint PASSED [ 35%]
tests/tokenizer/test_sentinel_tokens.py::TestSentinelTokens::test_token_ids_defined PASSED [ 35%]
tests/tokenizer/test_sentinel_tokens.py::TestSentinelTokens::test_token_strings_defined PASSED [ 35%]
tests/tokenizer/test_sentinel_tokens.py::TestSentinelTokens::test_tokens_in_special_tokens_map PASSED [ 35%]
tests/tokenizer/test_sentinel_tokens.py::TestSentinelTokens::test_tokens_in_tokenizer_config PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_valid_tensor PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_valid_float PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_missing_total PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_nan_tensor PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_inf_tensor PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_nan_component PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_zero_loss PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_zero_loss_with_nonzero_component PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_with_step PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_inf_component PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_multiple_components PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_non_tensor_invalid PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_non_tensor_inf PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_non_tensor_negative_inf PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_tensor_with_some_nan PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_tensor_with_some_inf PASSED [ 35%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_empty_loss_dict PASSED [ 36%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_zero_loss_all_zero_components PASSED [ 36%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_component_with_some_nan PASSED [ 36%]
tests/training/test_assertions.py::TestAssertLossFinite::test_assert_loss_finite_component_with_some_inf PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_logs_at_step PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_skips_non_log_step PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_includes_all_components PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_float_values PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_mixed_types PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_empty_dict PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_single_component PASSED [ 36%]
tests/training/test_assertions.py::TestLogLossComponents::test_log_loss_components_sorted_output PASSED [ 36%]
tests/training/test_assertions.py::TestComputeGradientNorms::test_compute_gradient_norms_with_gradients PASSED [ 36%]
tests/training/test_assertions.py::TestComputeGradientNorms::test_compute_gradient_norms_no_gradients PASSED [ 36%]
tests/training/test_assertions.py::TestComputeGradientNorms::test_compute_gradient_norms_multiple_parameters PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_balanced PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_imbalanced PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_single_component PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_empty PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_custom_threshold PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalance::test_check_gradient_balance_zero_min PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalanceEdgeCases::test_check_gradient_balance_all_zero PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalanceEdgeCases::test_check_gradient_balance_exact_threshold PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalanceEdgeCases::test_check_gradient_balance_just_over_threshold PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalanceEdgeCases::test_check_gradient_balance_multiple_components PASSED [ 36%]
tests/training/test_assertions.py::TestCheckGradientBalanceEdgeCases::test_check_gradient_balance_window_size_parameter PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_single_component PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_multiple_components PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_zero_weight PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_restores_gradients PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_skips_total PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_no_gradients_original PASSED [ 36%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_missing_weight PASSED [ 37%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_restores_none_gradients PASSED [ 37%]
tests/training/test_assertions.py::TestComputePerComponentGradientNorms::test_compute_per_component_gradient_norms_with_none_grads_in_loop PASSED [ 37%]
tests/training/test_assertions.py::TestAssertionsIntegration::test_loss_assertion_with_gradient_computation PASSED [ 37%]
tests/training/test_assertions.py::TestAssertionsIntegration::test_gradient_balance_check_after_computation PASSED [ 37%]
tests/training/test_caws_context.py::TestCAWSContext::test_caws_context_creation PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_no_caws_dir PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_legacy_spec PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_feature_spec PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_with_policy PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_default_budget PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_with_acceptance_criteria PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_with_invariants PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContext::test_extract_caws_context_string_invariants PASSED [ 37%]
tests/training/test_caws_context.py::TestFormatCAWSContextForPrompt::test_format_caws_context_for_prompt_none PASSED [ 37%]
tests/training/test_caws_context.py::TestFormatCAWSContextForPrompt::test_format_caws_context_for_prompt_verbose PASSED [ 37%]
tests/training/test_caws_context.py::TestFormatCAWSContextForPrompt::test_format_caws_context_for_prompt_compact PASSED [ 37%]
tests/training/test_caws_context.py::TestFormatCAWSContextForPrompt::test_format_caws_context_for_prompt_with_acceptance PASSED [ 37%]
tests/training/test_caws_context.py::TestFormatCAWSContextForPrompt::test_format_caws_context_for_prompt_with_invariants PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContextDict::test_extract_caws_context_dict_no_context PASSED [ 37%]
tests/training/test_caws_context.py::TestExtractCAWSContextDict::test_extract_caws_context_dict_valid PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_baseline PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_with_policy PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_with_waivers PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_inactive_waiver PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_multiple_waivers PASSED [ 37%]
tests/training/test_caws_context.py::TestDeriveBudget::test_derive_budget_string_waiver_ids PASSED [ 37%]
tests/training/test_caws_context.py::TestCAWSContextIntegration::test_complete_caws_context_workflow PASSED [ 37%]
tests/training/test_claim_extraction.py::TestExtractedClaim::test_extracted_claim_creation PASSED [ 37%]
tests/training/test_claim_extraction.py::TestExtractedClaim::test_extracted_claim_with_context PASSED [ 37%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_dates PASSED [ 37%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_code_blocks PASSED [ 37%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_json PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_urls PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_skips_unverifiable PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_skips_subjective PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_decomposes_compound PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_empty_text PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_plain_text PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_context_brackets PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claim_count PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claim_success_rate PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claim_success_rate_empty PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claim_success_rate_all_verifiable PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_version_numbers PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_with_proper_nouns PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_confidence_scores PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_confidence_higher_for_structured PASSED [ 38%]
tests/training/test_claim_extraction.py::TestSimpleClaimExtractor::test_extract_claims_multiple_sentences PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_basic PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_structure PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_ratios PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_zero_teacher PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_empty_outputs PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_creates_extractor PASSED [ 38%]
tests/training/test_claim_extraction.py::TestComputeClaimExtractionMetrics::test_compute_claim_extraction_metrics_with_structured_content PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_split_sentences_without_spaces_after_punctuation PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_split_sentences_whitespace_only PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_split_sentences_multiple_punctuation PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_with_code_blocks PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_structured_content_branch PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_with_braces PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_with_brackets PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_factual_structure_only PASSED [ 38%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_verifiable_content_no_patterns_no_structure PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_factual_structure_with_verb_and_nouns PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_factual_structure_without_verb PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_factual_structure_without_enough_nouns PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_factual_structure_with_different_verbs PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_has_factual_structure_past_participle_branch PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_no_splits PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_with_and PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_with_or PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_with_but PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_with_comma PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_decompose_to_atomic_multiple_conjunctions PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_base_value PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_multiple_patterns PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_code_block PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_json_braces PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_brackets PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_factual_structure PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_with_unverifiable_penalty PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_max_bound PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_compute_confidence_min_bound PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_extract_claim_success_rate_with_unverifiable_mixed PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_extract_claim_success_rate_all_unverifiable PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionEdgeCases::test_extract_claim_success_rate_verifiable_with_unverifiable_flags PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionIntegration::test_complete_claim_extraction_workflow PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionIntegration::test_claim_extraction_with_metrics PASSED [ 39%]
tests/training/test_claim_extraction.py::TestClaimExtractionIntegration::test_claim_extraction_edge_cases PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_valid PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_missing_required_model PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_missing_required_training PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_invalid_model_type PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_invalid_training_type PASSED [ 39%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_invalid_enum PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_invalid_range PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateTrainingConfig::test_validate_training_config_optional_fields PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_valid_yaml PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_valid_json PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_not_found PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_invalid_yaml PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_invalid_json PASSED [ 40%]
tests/training/test_config_validation.py::TestValidateConfigFile::test_validate_config_file_invalid_schema PASSED [ 40%]
tests/training/test_config_validation.py::TestCreateDefaultConfig::test_create_default_config_structure PASSED [ 40%]
tests/training/test_config_validation.py::TestCreateDefaultConfig::test_create_default_config_model_fields PASSED [ 40%]
tests/training/test_config_validation.py::TestCreateDefaultConfig::test_create_default_config_training_fields PASSED [ 40%]
tests/training/test_config_validation.py::TestCreateDefaultConfig::test_create_default_config_validates PASSED [ 40%]
tests/training/test_config_validation.py::TestCreateDefaultConfig::test_create_default_config_optional_fields PASSED [ 40%]
tests/training/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_yaml PASSED [ 40%]
tests/training/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_json PASSED [ 40%]
tests/training/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_creates_directory PASSED [ 40%]
tests/training/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_validates PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_single_file PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_multiple_files PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_deep_merge PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_file_not_found PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_invalid_file PASSED [ 40%]
tests/training/test_config_validation.py::TestMergeConfigs::test_merge_configs_empty_list PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_valid_file PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_empty_file PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_single_line PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_with_whitespace PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_invalid_json PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_unicode_content PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_encoding_utf8 PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_iterator_behavior PASSED [ 40%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_complex_nested_structures PASSED [ 41%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_file_not_found PASSED [ 41%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_large_file PASSED [ 41%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_no_newline_at_end PASSED [ 41%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_numeric_types PASSED [ 41%]
tests/training/test_dataloader.py::TestLoadJSONL::test_load_jsonl_boolean_and_null PASSED [ 41%]
tests/training/test_dataset.py::TestLoadTokenizer::test_load_tokenizer_basic PASSED [ 41%]
tests/training/test_dataset.py::TestLoadTokenizer::test_load_tokenizer_with_pad_token PASSED [ 41%]
tests/training/test_dataset.py::TestLoadTokenizer::test_load_tokenizer_no_transformers PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_basic PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_with_header PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_nonexistent_file PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_missing_fields PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_cot_validation PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_basic PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_with_process_targets PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_with_teacher_logits PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_with_quality_score PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_truncation PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_with_training_text PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_getitem_with_loss_mask PASSED [ 41%]
tests/training/test_dataset.py::TestKDDataset::test_kd_dataset_init_no_transformers PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_basic PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_with_padding PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_with_teacher_targets PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_with_teacher_logits PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_with_process_targets PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_with_loss_mask PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_empty_batch PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_single_item PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_mixed_optional_fields PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_load_data_empty_lines PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_load_data_json_decode_error PASSED [ 41%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_with_latent_curriculum PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_span_targets_computation PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_target_padding PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_target_truncation PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_loss_mask_padding PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_logits_padding PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_quality_score_string PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_quality_score_invalid_string PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_hidden_states PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_hidden_states_empty PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_kd_dataset_getitem_teacher_hidden_states_invalid PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_collate_kd_batch_padding_operations PASSED [ 42%]
tests/training/test_dataset.py::TestCollateKDBatch::test_load_tokenizer_import_error_path PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_span_targets_exception_handling PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_teacher_target_ids_truncation PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_teacher_logits_dim2_padding PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_hidden_states_non_list_break PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_hidden_states_exception_handling PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetEdgeCases::test_kd_dataset_loss_mask_list_to_tensor PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_load_data_with_dataset_sha256 PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_getitem_teacher_target_ids_padding_branch FAILED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_getitem_teacher_target_ids_truncation_branch PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_getitem_loss_mask_padding_branch PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_getitem_teacher_logits_dim2_padding_branch FAILED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_getitem_teacher_quality_score_value_error_branch PASSED [ 42%]
tests/training/test_dataset.py::TestKDDatasetBranchCoverage::test_kd_dataset_hidden_states_empty_tensors_fallback PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestLoadConfig::test_load_config_valid_yaml PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestLoadConfig::test_load_config_nonexistent_file PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestCreateModel::test_create_model_default_config PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestCreateModel::test_create_model_custom_config PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestCreateModel::test_create_model_with_checkpoint PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestCreateModel::test_create_model_checkpoint_no_model_state_dict PASSED [ 42%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_train_step_basic PASSED [ 43%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_train_step_with_scaler PASSED [ 43%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_train_step_with_ignore_index PASSED [ 43%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_create_model_checkpoint_path_nonexistent PASSED [ 43%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_create_model_no_checkpoint_config PASSED [ 43%]
tests/training/test_distill_answer_generation.py::TestTrainStep::test_create_model_checkpoint_no_model_state_dict PASSED [ 43%]
tests/training/test_distill_answer_generation_main.py::TestMain::test_main_basic_setup PASSED [ 43%]
tests/training/test_distill_answer_generation_main.py::TestMain::test_main_with_fp16_scaler PASSED [ 43%]
tests/training/test_distill_answer_generation_main.py::TestMain::test_main_checkpoint_saving PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_compute_required_fields_present_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_get_sequence_length_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_sample_enumerated_shape_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_should_enable_qat_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_apply_qat_to_model_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_check_qat_stability_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestUtilityFunctions::test_truncate_batch_to_shape_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_load_config_valid_yaml PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_load_config_nonexistent_file PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_merge_configs_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_merge_configs_overrides PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_merge_configs_env_overrides PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_merge_configs_deep_merge_branch PASSED [ 43%]
tests/training/test_distill_kd.py::TestConfigOperations::test_merge_configs_direct_assignment_branch PASSED [ 43%]
tests/training/test_distill_kd.py::TestModelCreation::test_create_model_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestModelCreation::test_create_model_with_quantization PASSED [ 43%]
tests/training/test_distill_kd.py::TestModelCreation::test_create_model_invalid_config PASSED [ 43%]
tests/training/test_distill_kd.py::TestModelCreation::test_create_model_arch_not_dict PASSED [ 43%]
tests/training/test_distill_kd.py::TestModelCreation::test_create_model_missing_arch PASSED [ 43%]
tests/training/test_distill_kd.py::TestOptimizerCreation::test_create_optimizer_adamw PASSED [ 43%]
tests/training/test_distill_kd.py::TestOptimizerCreation::test_create_optimizer_default_config PASSED [ 43%]
tests/training/test_distill_kd.py::TestOptimizerCreation::test_create_optimizer_invalid_type PASSED [ 43%]
tests/training/test_distill_kd.py::TestSequenceLength::test_get_sequence_length_basic PASSED [ 43%]
tests/training/test_distill_kd.py::TestSequenceLength::test_get_sequence_length_with_curriculum PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_with_probs PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_periodic_upweight PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_default_probs_4 PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_default_probs_3 PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_default_probs_2 PASSED [ 44%]
tests/training/test_distill_kd.py::TestSequenceLength::test_sample_enumerated_shape_uniform_fallback PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_should_enable_qat_false PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_should_enable_qat_true PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_should_enable_qat_no_config PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_apply_qat_to_model PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_apply_qat_to_model_success PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_apply_qat_to_model_with_custom_config PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_check_qat_stability_valid PASSED [ 44%]
tests/training/test_distill_kd.py::TestQATOperations::test_check_qat_stability_nan_weights PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_basic PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_vocab_clamping PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_cot_free_validation PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_cot_free_validation_list_with_none PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_cot_free_validation_list_all_none PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_vocab_clamping_warning_branch PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_vocab_clamping_no_warning_branch PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_with_intermediate_layers PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_with_self_evaluation PASSED [ 44%]
tests/training/test_distill_kd.py::TestTrainingStep::test_train_step_with_halt_head PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_truncate_batch_to_shape_seq_vocab_keys PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_truncate_batch_to_shape_no_truncation_needed PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_truncate_batch_to_shape_other_keys PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_truncate_batch_to_shape_seq_vocab_truncation PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_compute_required_fields_present_basic PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_compute_required_fields_present_with_json_validity PASSED [ 44%]
tests/training/test_distill_kd.py::TestBatchOperations::test_compute_required_fields_present_with_json_validity_partial_coverage PASSED [ 45%]
tests/training/test_distill_kd.py::TestBatchOperations::test_truncate_batch_to_shape PASSED [ 45%]
tests/training/test_distill_kd.py::TestCheckpointOperations::test_save_checkpoint_basic PASSED [ 45%]
tests/training/test_distill_kd.py::TestCheckpointOperations::test_save_checkpoint_with_metadata PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_valid PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_missing_model PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_missing_training PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_lr PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_vocab_size PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_d_model PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_n_layers PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_steps PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_n_heads PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_invalid_batch_size PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_distillation_and_code_mode_warning PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_latent_and_code_mode_warning PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_multiple_errors PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_zero_values PASSED [ 45%]
tests/training/test_distill_kd.py::TestConfigValidation::test_validate_config_main_error_handling PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_empty_batch PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_no_validated_args PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_fallback_heuristic PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_with_student_logits PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_no_tool_call PASSED [ 45%]
tests/training/test_distill_kd.py::TestComputeRequiredFieldsPresent::test_compute_required_fields_present_no_tool_name PASSED [ 45%]
tests/training/test_distill_kd.py::TestMergeConfigsEnvOverrides::test_merge_configs_env_train_latent PASSED [ 45%]
tests/training/test_distill_kd.py::TestMergeConfigsEnvOverrides::test_merge_configs_env_latent_mode PASSED [ 45%]
tests/training/test_distill_kd.py::TestMergeConfigsEnvOverrides::test_merge_configs_env_halt_head PASSED [ 45%]
tests/training/test_distill_kd.py::TestMergeConfigsEnvOverrides::test_merge_configs_provenance_metadata PASSED [ 45%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_with_checkpoint PASSED [ 45%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_with_self_evaluation PASSED [ 45%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_with_intermediate_layers PASSED [ 45%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_checkpoint_not_found PASSED [ 46%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_checkpoint_with_model_state_dict_branch PASSED [ 46%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_checkpoint_without_model_state_dict PASSED [ 46%]
tests/training/test_distill_kd.py::TestModelCreationExpanded::test_create_model_checkpoint_loading_exception PASSED [ 46%]
tests/training/test_distill_kd.py::TestOptimizerCreationExpanded::test_create_optimizer_adam PASSED [ 46%]
tests/training/test_distill_kd.py::TestOptimizerCreationExpanded::test_create_optimizer_else_branch PASSED [ 46%]
tests/training/test_distill_kd.py::TestOptimizerCreationExpanded::test_create_optimizer_with_projection_layers PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_get_sequence_length_curriculum_early_step PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_get_sequence_length_curriculum_boundary PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_get_sequence_length_curriculum_beyond_schedule PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_sample_enumerated_shape_with_probs PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_sample_enumerated_shape_periodic_upweight PASSED [ 46%]
tests/training/test_distill_kd.py::TestSequenceLengthExpanded::test_sample_enumerated_shape_default_probs PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_should_enable_qat_default_start_fraction PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_should_enable_qat_custom_start_fraction PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_with_baseline PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_with_baseline_hidden_states PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_with_hidden_states PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_hidden_states_similarity_computation PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_no_layers_to_compare PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_no_baseline_available PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_exception_handling PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_exception_during_computation PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_with_ddp_model PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_with_precomputed_baseline_states PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_model_without_hidden_states PASSED [ 46%]
tests/training/test_distill_kd.py::TestQATOperationsExpanded::test_check_qat_stability_error_handling PASSED [ 46%]
tests/training/test_distill_kd.py::TestTruncateBatchToShapeExpanded::test_truncate_batch_to_shape_all_keys PASSED [ 46%]
tests/training/test_distill_kd.py::TestTruncateBatchToShapeExpanded::test_truncate_batch_to_shape_no_truncation_needed PASSED [ 46%]
tests/training/test_distill_kd.py::TestTruncateBatchToShapeExpanded::test_truncate_batch_to_shape_metadata_preserved PASSED [ 46%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_atomic_write PASSED [ 46%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_with_rng_states PASSED [ 46%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_with_dataset_fingerprint PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_with_code_mode_metadata PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_with_ddp_model PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_exception_handling PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_fsync_exception PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_loss_components_float PASSED [ 47%]
tests/training/test_distill_kd.py::TestSaveCheckpointExpanded::test_save_checkpoint_loss_components_tensor_conversion PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_process_supervision PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_entropy_scheduling PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_temperature_schedule PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_weight_schedule PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_length_aware_kd PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_early_tool_call PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_code_mode_loss PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_code_mode_weight_warmup PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_code_mode_batch_meta_as_dict PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_code_mode_batch_meta_dict_span_targets_list PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_halt_targets_batch_metadata_expansion PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_halt_targets_import_error PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_intermediate_layers_and_teacher_states PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_intermediate_layers_default_mapping PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_intermediate_layers_projection_creation PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_json_repair_check SKIPPED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_gradient_accumulation PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_fp16_scaler PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_teacher_targets PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_loss_mask PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_halt_targets_derivation PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_halt_targets_warmup PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_code_mode_loss_fallback_init PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_caws_structure_loss PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_caws_structure_loss_list_teacher_text PASSED [ 47%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_caws_compliance_loss PASSED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_caws_compliance_loss_from_metadata PASSED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_loss SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_teacher_text_from_metadata SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_teacher_text_list SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_teacher_text_non_string SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_extractor_full_type SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_extractor_unknown_type SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_claim_extraction_decode_error PASSED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_self_evaluation_loss PASSED [ 48%]
tests/training/test_distill_kd.py::TestTrainingStepExpanded::test_train_step_with_early_tool_call_teacher_prefix PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_version_check_failure PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_config_validation_failure PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_config_provenance_logging PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_tokenizer_migration_success PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_tokenizer_migration_failure PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_main_resume_checkpoint_config_validation PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_gradient_accumulation_with_scaler_and_grad_norm SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_gradient_accumulation_with_scaler_no_grad_norm SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_normal_update_with_scaler SKIPPED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_halt_logits_with_hidden_states PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_halt_logits_with_eval_score PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_halt_logits_without_other_flags PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_halt_logits_tuple_extraction_separate_pass PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_halt_logits_tuple_extraction_combined_pass PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_with_tool_result_fields PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_real_execution PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_with_integration_mask PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_eval_score_with_hidden_states PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_eval_score_without_hidden_states PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_train_step_tokenizer_from_model PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_baseline_outputs_tuple_handling PASSED [ 48%]
tests/training/test_distill_kd.py::TestMainFunction::test_baseline_outputs_single_item_tuple PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_rng_states_none_handling PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_ddp_model_handling PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_speed_metrics_import_handling PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_tokenizer_hasattr_checks PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_checkpoint_key_membership PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_optimizer_param_groups_check PASSED [ 49%]
tests/training/test_distill_kd.py::TestMainFunction::test_checkpoint_frequency_calculation PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_simple_extractor PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_full_extractor_fallback PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_unknown_extractor_type PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_teacher_text_list PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_teacher_text_non_string PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_metrics_logging_disabled PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_exception_handling PASSED [ 49%]
tests/training/test_distill_kd.py::TestClaimExtractionIntegration::test_train_step_with_claim_extraction_teacher_text_from_metadata PASSED [ 49%]
tests/training/test_distill_kd.py::TestOptionalImports::test_latent_curriculum_not_available_when_enabled PASSED [ 49%]
tests/training/test_distill_kd.py::TestOptionalImports::test_tokenizer_migration_skipped_when_not_available PASSED [ 49%]
tests/training/test_distill_kd.py::TestOptionalImports::test_speed_metrics_skipped_when_not_available PASSED [ 49%]
tests/training/test_distill_kd.py::TestDistributedTraining::test_main_distributed_setup_with_local_rank PASSED [ 49%]
tests/training/test_distill_kd.py::TestDistributedTraining::test_main_non_distributed_setup_with_local_rank_negative PASSED [ 49%]
tests/training/test_distill_kd.py::TestJSONRepairIntegration::test_train_step_with_json_repair_loss_integration PASSED [ 49%]
tests/training/test_distill_kd.py::TestJSONRepairIntegration::test_train_step_json_repair_exception_handling PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_qat_enabling_with_ddp_model_path PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_qat_enabling_with_non_ddp_model_path PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_enumerated_shapes_path_in_loop PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_curriculum_path_in_loop PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_checkpoint_milestone_path PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_large_model_checkpoint_frequency PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_regular_model_checkpoint_frequency PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_qat_optimizer_recreation_path PASSED [ 49%]
tests/training/test_distill_kd_training_loop.py::TestTrainingLoopPaths::test_qat_stability_check_path PASSED [ 49%]
tests/training/test_distill_post_tool.py::TestLoadConfig::test_load_config_valid_yaml PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestLoadConfig::test_load_config_nonexistent_file PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_default_config PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_custom_config PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_with_checkpoint PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_checkpoint_path_nonexistent PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_no_checkpoint_config PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestCreateModel::test_create_model_checkpoint_no_model_state_dict PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestMain::test_main_basic_flow PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestTrainStep::test_train_step_basic PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestTrainStep::test_train_step_with_scaler PASSED [ 50%]
tests/training/test_distill_post_tool.py::TestTrainStep::test_train_step_with_ignore_index PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_load_config_success PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_load_config_file_not_found PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_load_config_invalid_yaml PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_merge_configs_empty_list PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_merge_configs_single_config PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_merge_configs_multiple_configs PASSED [ 50%]
tests/training/test_distill_process.py::TestConfigOperations::test_merge_configs_nested_merge PASSED [ 50%]
tests/training/test_distill_process.py::TestModelLoading::test_load_model_success PASSED [ 50%]
tests/training/test_distill_process.py::TestModelLoading::test_load_model_without_config PASSED [ 50%]
tests/training/test_distill_process.py::TestModelLoading::test_load_model_checkpoint_not_found PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_basic PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_temperature PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_top_k PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_top_p PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_greedy PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_empty_logits PASSED [ 50%]
tests/training/test_distill_process.py::TestTextGeneration::test_generate_text_from_logits_single_token PASSED [ 50%]
tests/training/test_distill_process.py::TestTrainingStep::test_train_step_process_basic PASSED [ 50%]
tests/training/test_distill_process.py::TestTrainingStep::test_train_step_process_zero_weights PASSED [ 50%]
tests/training/test_distill_process.py::TestTrainingStep::test_train_step_process_no_grad PASSED [ 50%]
tests/training/test_distill_process.py::TestTrainingStep::test_train_step_process_missing_process_labels PASSED [ 50%]
tests/training/test_distill_process.py::TestMainFunction::test_main_success PASSED [ 51%]
tests/training/test_distill_process.py::TestMainFunction::test_main_config_load_failure PASSED [ 51%]
tests/training/test_distill_process.py::TestMainFunction::test_main_model_load_failure PASSED [ 51%]
tests/training/test_distill_process.py::TestProcessSupervisionIntegration::test_process_supervision_config_structure PASSED [ 51%]
tests/training/test_distill_process.py::TestProcessSupervisionIntegration::test_process_labels_structure PASSED [ 51%]
tests/training/test_distill_process.py::TestProcessSupervisionIntegration::test_training_config_validation PASSED [ 51%]
tests/training/test_distill_process.py::TestTrainStepProcessExpanded::test_train_step_process_with_tool_name_ids PASSED [ 51%]
tests/training/test_distill_process.py::TestTrainStepProcessExpanded::test_train_step_process_with_fp16_scaler PASSED [ 51%]
tests/training/test_distill_process.py::TestTrainStepProcessExpanded::test_train_step_process_no_tool_name_ids PASSED [ 51%]
tests/training/test_distill_process.py::TestGenerateTextFromLogitsExpanded::test_generate_text_from_logits_with_decode_error PASSED [ 51%]
tests/training/test_distill_process.py::TestGenerateTextFromLogitsExpanded::test_generate_text_from_logits_single_batch PASSED [ 51%]
tests/training/test_distill_process.py::TestGenerateTextFromLogitsExpanded::test_generate_text_from_logits_large_vocab PASSED [ 51%]
tests/training/test_distill_process.py::TestGenerateTextFromLogitsExpanded::test_generate_text_from_logits_long_sequence PASSED [ 51%]
tests/training/test_distill_process.py::TestMainFunctionExpanded::test_main_with_hf_tokenizer_unavailable PASSED [ 51%]
tests/training/test_distill_process.py::TestMainFunctionExpanded::test_main_checkpoint_saving PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestLoadConfig::test_load_config_valid_yaml PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestLoadConfig::test_load_config_nonexistent_file PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestCreateModel::test_create_model_basic PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestCreateModel::test_create_model_with_checkpoint PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestCreateModel::test_create_model_default_values PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_basic PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_with_decoder PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_with_fp16 PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_zero_weights PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_no_tool_names PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_decoder_incomplete PASSED [ 51%]
tests/training/test_distill_tool_select.py::TestTrainStep::test_train_step_decoder_invalid PASSED [ 51%]
tests/training/test_export_student.py::TestTorchScriptExport::test_export_torchscript_success PASSED [ 51%]
tests/training/test_export_student.py::TestTorchScriptExport::test_export_torchscript_directory_creation PASSED [ 51%]
tests/training/test_export_student.py::TestTorchScriptExport::test_export_torchscript_trace_failure PASSED [ 51%]
tests/training/test_export_student.py::TestExportedProgramExport::test_export_exported_program_success PASSED [ 51%]
tests/training/test_export_student.py::TestExportedProgramExport::test_export_exported_program_directory_creation PASSED [ 51%]
tests/training/test_export_student.py::TestExportedProgramExport::test_export_exported_program_no_torch_export PASSED [ 52%]
tests/training/test_export_student.py::TestContractCreation::test_create_contract_success PASSED [ 52%]
tests/training/test_export_student.py::TestContractCreation::test_create_contract_directory_creation PASSED [ 52%]
tests/training/test_export_student.py::TestContractCreation::test_create_contract_file_writing PASSED [ 52%]
tests/training/test_export_student.py::TestMainFunction::test_main_basic_setup PASSED [ 52%]
tests/training/test_export_student.py::TestMainFunction::test_main_checkpoint_not_found PASSED [ 52%]
tests/training/test_export_student.py::TestExportIntegration::test_export_workflow PASSED [ 52%]
tests/training/test_export_student.py::TestExportIntegration::test_export_error_handling PASSED [ 52%]
tests/training/test_export_student.py::TestConfigurationHandling::test_contract_creation_with_different_configs PASSED [ 52%]
tests/training/test_export_student.py::TestConfigurationHandling::test_export_with_different_input_shapes PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_valid_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_text_with_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_no_name_field PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_not_dict PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_invalid_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_plain_text PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_nested_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_multiple_json_objects PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolCall::test_extract_tool_call_with_tool_names_filter PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolNameSpan::test_extract_tool_name_span_valid PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolNameSpan::test_extract_tool_name_span_text_with_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolNameSpan::test_extract_tool_name_span_no_tool_call PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolNameSpan::test_extract_tool_name_span_invalid_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractToolNameSpan::test_extract_tool_name_span_with_tool_names PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_single_object PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_multiple_objects PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_nested_objects PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_invalid_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_no_json PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_empty_string PASSED [ 52%]
tests/training/test_extractors.py::TestExtractJSONArgumentSpans::test_extract_json_argument_spans_arrays PASSED [ 52%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_citation_patterns PASSED [ 52%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_based_on_pattern PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_with_tool_results PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_direct_copying PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_numeric_values PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_list_length PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_structured_data PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_after_tool_call PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_no_integration PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_empty_string PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_merges_overlapping PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_multiple_tool_results PASSED [ 53%]
tests/training/test_extractors.py::TestIdentifyIntegrationSpans::test_identify_integration_spans_fuzzy_matching PASSED [ 53%]
tests/training/test_extractors.py::TestExtractorsIntegration::test_complete_extraction_workflow PASSED [ 53%]
tests/training/test_extractors.py::TestExtractorsIntegration::test_extraction_with_tool_results PASSED [ 53%]
tests/training/test_extractors.py::TestExtractorsIntegration::test_extraction_edge_cases PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureFlagEnum::test_feature_flag_values PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureFlagEnum::test_feature_flag_count PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureFlagEnum::test_feature_flag_uniqueness PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureConfig::test_feature_config_creation PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureConfig::test_feature_config_empty_sets PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_initialization PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_get_enabled_features PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_is_enabled PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_enable_feature PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_disable_feature PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_enable_with_dependencies PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_enable_with_conflicts PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_validate_configuration PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_get_feature_status PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_load_from_environment PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_load_from_config PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_validate_configuration_returns_list PASSED [ 53%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_apply_to_config PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_apply_to_config_code_mode PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_apply_to_config_latent_reasoning PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_apply_to_config_quantization PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_apply_to_config_halt_head PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_disable_with_dependents PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_validate_with_errors PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureManager::test_feature_manager_validate_with_conflicts PASSED [ 54%]
tests/training/test_feature_flags.py::TestInitializeFeatures::test_initialize_features_no_config PASSED [ 54%]
tests/training/test_feature_flags.py::TestInitializeFeatures::test_initialize_features_with_config PASSED [ 54%]
tests/training/test_feature_flags.py::TestInitializeFeatures::test_initialize_features_invalid_config PASSED [ 54%]
tests/training/test_feature_flags.py::TestInitializeFeatures::test_initialize_features_with_validation_errors PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureInteractions::test_circular_dependencies_prevention PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureInteractions::test_feature_enable_disable_cycle PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureInteractions::test_multiple_features_enable_disable PASSED [ 54%]
tests/training/test_feature_flags.py::TestFeatureInteractions::test_feature_manager_not_thread_safe PASSED [ 54%]
tests/training/test_feature_flags.py::TestEnvironmentIntegration::test_environment_variable_override PASSED [ 54%]
tests/training/test_feature_flags.py::TestEnvironmentIntegration::test_environment_variable_case_insensitive PASSED [ 54%]
tests/training/test_feature_flags.py::TestEnvironmentIntegration::test_environment_variable_invalid_values PASSED [ 54%]
tests/training/test_feature_flags.py::TestEnvironmentIntegration::test_environment_variable_precedence PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_initialization_default PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_initialization_custom PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_curriculum_at_max_loops PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_curriculum_before_max_loops PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_curriculum_stage_0 PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_curriculum_stage_1 PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_curriculum_stage_2_plus PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_judge_above_threshold_no_prev PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_judge_above_threshold_delta_shrinking PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_judge_above_threshold_large_delta PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_judge_below_threshold PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_judge_at_threshold PASSED [ 54%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_combined_max_loops PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_combined_judge_halts PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_combined_curriculum_fallback PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_derive_from_combined_no_signals PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_should_apply_loss_before_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_should_apply_loss_at_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_should_apply_loss_after_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltHeadTargets::test_should_apply_loss_zero_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_before_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_after_warmup PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_missing_metadata PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_empty_metadata PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_curriculum_stage_variations PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_judge_score_variations PASSED [ 55%]
tests/training/test_halt_targets.py::TestCreateHaltTargetsBatch::test_create_batch_max_loops_edge_cases PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltTargetsIntegration::test_training_progression_curriculum PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltTargetsIntegration::test_training_progression_judge PASSED [ 55%]
tests/training/test_halt_targets.py::TestHaltTargetsIntegration::test_warmup_schedule PASSED [ 55%]
tests/training/test_input_validation.py::TestValidationError::test_validation_error_creation PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validator_initialization PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_valid PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_non_string PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_non_string_lenient PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_too_long PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_too_long_lenient PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_suspicious_script_tag PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_suspicious_javascript_url PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_suspicious_event_handler PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_none_strict PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_none_lenient PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_text_input_suspicious_lenient PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_contains_suspicious_patterns_non_string PASSED [ 55%]
tests/training/test_input_validation.py::TestInputValidator::test_contains_suspicious_patterns_matches PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_contains_suspicious_patterns_no_match PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_numeric_input_valid PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_numeric_input_string_number PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_numeric_input_below_min PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_numeric_input_above_max PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_numeric_input_invalid_type PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_valid PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_not_dict PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_missing_name PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_missing_arguments PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_invalid_name_format PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_valid PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_not_list PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_too_many PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_invalid_tool_type PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_missing_name PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tools_missing_description PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_valid PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_not_dict PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_missing_required PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_custom_required_fields PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_invalid_required_type PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_nested_dict PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_primitive_types PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_invalid_type PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_structured_data_optional_string_field PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_tool_call_arguments_not_dict PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_valid PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_not_dict PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_invalid_cot_steps PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_missing_prompt PASSED [ 56%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_with_answer_alias PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_training_example_missing_response_and_answer PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_not_dict PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_invalid_tool_count PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_tool_count_too_high PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_invalid_intermediate_sizes PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_metadata_invalid_boolean_field PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_batch_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_batch_not_dict PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_batch_not_tensor PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_batch_nan_values PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_batch_inf_values PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_sanitize_json_string_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_sanitize_json_string_null_bytes PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_sanitize_json_string_too_long PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_not_exist PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_not_exist_optional PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_permission_error PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_stat_permission_error PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_invalid_path PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_dangerous_extension PASSED [ 57%]
tests/training/test_input_validation.py::TestInputValidator::test_validate_file_path_too_large PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateTrainingData::test_validate_training_data_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateTrainingData::test_validate_training_data_invalid_example PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateTrainingData::test_validate_training_data_not_list PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateTrainingData::test_validate_training_data_empty_list PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_valid PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_not_list PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_invalid_tool_call PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_not_dict PASSED [ 57%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_missing_tool_name PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_missing_tool_input PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_missing_tool_output PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_non_string_input PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_non_string_output PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_preserves_other_fields PASSED [ 58%]
tests/training/test_input_validation.py::TestValidateToolTrace::test_validate_tool_trace_empty_list PASSED [ 58%]
tests/training/test_input_validation.py::TestGlobalValidator::test_global_validator_exists PASSED [ 58%]
tests/training/test_input_validation.py::TestGlobalValidator::test_global_validator_strict_mode PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_training_example_missing_response_after_check PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_file_path_stat_permission_error_handling PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_training_example_with_both_response_and_answer PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_file_path_directory_not_file PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_file_path_path_is_not_file PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_batch_tensor_without_isnan PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_batch_tensor_without_isinf PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_file_path_relative_to_success PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_metadata_eligible_for_code_mode PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_training_example_cot_steps_with_suspicious_content PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_batch_partial_tensor_fields PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_batch_all_tensor_fields PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_sanitize_json_string_exactly_at_boundary PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_metadata_intermediate_sizes_empty_list PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_metadata_intermediate_sizes_multiple PASSED [ 58%]
tests/training/test_input_validation.py::TestInputValidatorAdditional::test_validate_metadata_preserves_unknown_fields PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_valid_object PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_valid_array PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_invalid_missing_brace PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_invalid_trailing_comma PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_text_with_json PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_plain_text PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_empty_string PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_nested_object PASSED [ 58%]
tests/training/test_json_repair.py::TestValidateJSON::test_validate_json_array_with_objects PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_valid_object PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_plain_text PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_multiple_objects PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_entire_text_is_json PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_invalid_json PASSED [ 59%]
tests/training/test_json_repair.py::TestExtractJSONFromText::test_extract_json_from_text_empty_string PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_single_quotes PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_trailing_comma PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_trailing_comma_array PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_valid_json PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_empty_string PASSED [ 59%]
tests/training/test_json_repair.py::TestSimpleJSONRepair::test_simple_json_repair_whitespace PASSED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_already_valid PASSED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_simple_repair PASSED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_with_jsonrepair FAILED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_unrepairable PASSED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_without_jsonrepair PASSED [ 59%]
tests/training/test_json_repair.py::TestRepairJSON::test_repair_json_empty_string PASSED [ 59%]
tests/training/test_json_repair.py::TestCheckJSONRepairNeeded::test_check_json_repair_needed_valid_json PASSED [ 59%]
tests/training/test_json_repair.py::TestCheckJSONRepairNeeded::test_check_json_repair_needed_invalid_json FAILED [ 59%]
tests/training/test_json_repair.py::TestCheckJSONRepairNeeded::test_check_json_repair_needed_no_json PASSED [ 59%]
tests/training/test_json_repair.py::TestCheckJSONRepairNeeded::test_check_json_repair_needed_repairable_json FAILED [ 59%]
tests/training/test_json_repair.py::TestCheckJSONRepairNeeded::test_check_json_repair_needed_empty_string PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_empty_list PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_all_valid PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_mixed FAILED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_all_invalid PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_no_json PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_large_batch PASSED [ 59%]
tests/training/test_json_repair.py::TestBatchCheckJSONRepair::test_batch_check_json_repair_metrics_structure PASSED [ 59%]
tests/training/test_json_repair.py::TestJSONRepairIntegration::test_repair_workflow FAILED [ 59%]
tests/training/test_json_repair.py::TestJSONRepairIntegration::test_batch_workflow PASSED [ 60%]
tests/training/test_latent_curriculum.py::TestLatentCurriculum::test_curriculum_applies_latent_slots FAILED [ 60%]
tests/training/test_latent_curriculum.py::TestLatentCurriculum::test_curriculum_creates_loss_mask FAILED [ 60%]
tests/training/test_latent_curriculum.py::TestLatentCurriculum::test_curriculum_respects_probability PASSED [ 60%]
tests/training/test_latent_curriculum.py::TestLatentCurriculum::test_curriculum_handles_missing_cot_steps PASSED [ 60%]
tests/training/test_latent_curriculum.py::TestLatentCurriculum::test_loss_mask_masks_latent_spans FAILED [ 60%]
tests/training/test_logging_utils.py::TestStructuredLogger::test_structured_logger_initialization PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredLogger::test_structured_logger_no_duplicate_handlers PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredLogger::test_structured_logger_log_methods PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredLogger::test_structured_logger_propagate_disabled PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredLogger::test_structured_logger_formatter_assignment PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_format_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_format_with_extra PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_format_all_levels PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_format_with_exception PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_format_message_formatting PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_timestamp_format PASSED [ 60%]
tests/training/test_logging_utils.py::TestStructuredFormatter::test_structured_formatter_json_validity PASSED [ 60%]
tests/training/test_logging_utils.py::TestSetupTrainingLogging::test_setup_training_logging_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestSetupTrainingLogging::test_setup_training_logging_with_file PASSED [ 60%]
tests/training/test_logging_utils.py::TestSetupTrainingLogging::test_setup_training_logging_different_levels PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogTrainingStep::test_log_training_step_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogTrainingStep::test_log_training_step_zero_values PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogValidationMetrics::test_log_validation_metrics_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogValidationMetrics::test_log_validation_metrics_empty PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogValidationMetrics::test_log_validation_metrics_complex PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogCheckpointSaved::test_log_checkpoint_saved_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogCheckpointSaved::test_log_checkpoint_saved_different_paths PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogError::test_log_error_basic PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogError::test_log_error_no_context PASSED [ 60%]
tests/training/test_logging_utils.py::TestLogError::test_log_error_different_exceptions PASSED [ 60%]
tests/training/test_logging_utils.py::TestLoggingIntegration::test_structured_logging_workflow PASSED [ 60%]
tests/training/test_logging_utils.py::TestLoggingIntegration::test_logging_error_handling PASSED [ 61%]
tests/training/test_logging_utils.py::TestLoggingIntegration::test_logging_with_special_characters PASSED [ 61%]
tests/training/test_logging_utils.py::TestLoggingIntegration::test_logging_performance PASSED [ 61%]
tests/training/test_loss_mask_correctness.py::TestLossMaskCorrectness::test_loss_mask_masks_latent_tokens PASSED [ 61%]
tests/training/test_loss_mask_correctness.py::TestLossMaskCorrectness::test_loss_mask_alignment_after_padding PASSED [ 61%]
tests/training/test_loss_mask_correctness.py::TestLossMaskCorrectness::test_loss_mask_excludes_latent_spans_from_supervision FAILED [ 61%]
tests/training/test_loss_mask_correctness.py::TestLossMaskCorrectness::test_loss_mask_handles_empty_sequences PASSED [ 61%]
tests/training/test_loss_mask_correctness.py::TestLossMaskCorrectness::test_loss_mask_applied_to_combined_loss PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_basic PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_with_temperature PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_reduction_mean PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_reduction_mean_equality_check PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_reduction_sum PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_reduction_none PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_flattened_input PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_temperature_division_verification PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_temperature_division_vs_addition PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_temperature_scaling_effect PASSED [ 61%]
tests/training/test_losses.py::TestKLDivergence::test_kl_divergence_dimension_check_teacher_logits PASSED [ 61%]
tests/training/test_losses.py::TestCrossEntropyOnTeacher::test_cross_entropy_on_teacher_basic PASSED [ 61%]
tests/training/test_losses.py::TestCrossEntropyOnTeacher::test_cross_entropy_on_teacher_with_ignore_index PASSED [ 61%]
tests/training/test_losses.py::TestCrossEntropyOnTeacher::test_cross_entropy_on_teacher_gradient_flow PASSED [ 61%]
tests/training/test_losses.py::TestToolNameLoss::test_tool_name_loss_basic PASSED [ 61%]
tests/training/test_losses.py::TestToolNameLoss::test_tool_name_loss_with_mask PASSED [ 61%]
tests/training/test_losses.py::TestToolNameLoss::test_tool_name_loss_sequence_mismatch PASSED [ 61%]
tests/training/test_losses.py::TestJSONArgumentLoss::test_json_argument_loss_basic PASSED [ 61%]
tests/training/test_losses.py::TestJSONArgumentLoss::test_json_argument_loss_with_partial_mask PASSED [ 61%]
tests/training/test_losses.py::TestIntegrationCopyLoss::test_integration_copy_loss_basic PASSED [ 61%]
tests/training/test_losses.py::TestIntegrationCopyLoss::test_integration_copy_loss_with_mask PASSED [ 61%]
tests/training/test_losses.py::TestHaltHeadLoss::test_halt_head_loss_basic PASSED [ 61%]
tests/training/test_losses.py::TestHaltHeadLoss::test_halt_head_loss_all_continue PASSED [ 61%]
tests/training/test_losses.py::TestHaltHeadLoss::test_halt_head_loss_all_halt PASSED [ 61%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_basic PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_with_projection PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_sequence_mismatch PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_empty_mapping PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_boundary_check_gte PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_intermediate_layer_loss_boundary_equality_case PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_code_mode_preference_loss_tool_count_gte_min_tools PASSED [ 62%]
tests/training/test_losses.py::TestIntermediateLayerLoss::test_code_mode_preference_loss_tool_count_gte_boundary_check PASSED [ 62%]
tests/training/test_losses.py::TestSelfEvaluationLoss::test_self_evaluation_loss_basic PASSED [ 62%]
tests/training/test_losses.py::TestSelfEvaluationLoss::test_self_evaluation_loss_perfect_match PASSED [ 62%]
tests/training/test_losses.py::TestCreateProjectionLayers::test_create_projection_layers_basic PASSED [ 62%]
tests/training/test_losses.py::TestCreateProjectionLayers::test_create_projection_layers_output_shape PASSED [ 62%]
tests/training/test_losses.py::TestCreateProjectionLayers::test_create_projection_layers_none_append PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_basic PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_with_hinge PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_rel_excess_gt_hinge PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_reduction_mean PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_reduction_sum_equality PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_reduction_sum_equality_vs_lte PASSED [ 62%]
tests/training/test_losses.py::TestLengthAwareKDLoss::test_length_aware_kd_loss_subtraction_vs_floor_division PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_with_teacher_prefix PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_teacher_prefix_numel_gt_zero PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_addition_vs_division PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_without_teacher_prefix_json_prior PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_no_json_tokens PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_with_ramp PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_basic PASSED [ 62%]
tests/training/test_losses.py::TestEarlyToolCallLoss::test_early_tool_call_loss_disabled PASSED [ 62%]
tests/training/test_losses.py::TestCurriculumTemperature::test_curriculum_temperature_start PASSED [ 62%]
tests/training/test_losses.py::TestCurriculumTemperature::test_curriculum_temperature_end PASSED [ 62%]
tests/training/test_losses.py::TestCurriculumTemperature::test_curriculum_temperature_monotonic PASSED [ 62%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_basic PASSED [ 62%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_with_intermediate_layers PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_with_self_evaluation PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_code_mode_weight_positive_check PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_teacher_targets_none_check PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_json_loss_addition PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_json_loss_weight_multiplication PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_ground_truth_targets_none_check PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_halt_head_none_check PASSED [ 63%]
tests/training/test_losses.py::TestCombinedKDLoss::test_combined_kd_loss_kl_weight_gt_zero_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_basic PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_with_weight PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_forward_with_eligibility PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_forward_no_eligible PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_forward_no_span_targets PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_eligibility_intermediate_chars PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_eligibility_pii_tags PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_span_targets_none_handling PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_weight_multiplication_verification PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_vocab_ids_none_handling PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_batch_meta_is_none_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_eligibility_intermediate_chars_true_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_intermediate_sizes_length_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_num_eligible_gt_zero_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_prefer_ts_api_false_branch PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_penalize_tool_result_roundtrip_false_branch PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_num_eligible_zero_else_branch PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_penalize_tool_result_roundtrip_true_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_span_boundary_check_end_lte PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_span_boundary_and_check PASSED [ 63%]
tests/training/test_losses.py::TestCodeModePreferenceLoss::test_code_mode_preference_loss_span_boundary_check_start_lt PASSED [ 63%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_basic PASSED [ 63%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_with_weights PASSED [ 63%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_latent_span_count_boundary PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_output_length_boundary_lt PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_output_length_lt_vs_gte PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_output_length_lt_vs_gte_boundary PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_tool_usage_in_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_unsupported_claims_increment PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_claim_supported_by_teacher_substring_or_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_claim_supported_by_teacher_if_statement_true_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_if_statement_false_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_latent_span_count_boundary_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_output_length_lt_check PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_step_patterns_increment PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_caws_compliance_loss_code_patterns_penalty_increment PASSED [ 64%]
tests/training/test_losses.py::TestCAWSComplianceLoss::test_claim_supported_by_teacher_substring_in_vs_not_in PASSED [ 64%]
tests/training/test_losses.py::TestCAWSStructureLoss::test_caws_structure_loss_basic PASSED [ 64%]
tests/training/test_losses.py::TestCAWSStructureLoss::test_caws_structure_loss_perfect_match PASSED [ 64%]
tests/training/test_losses.py::TestCAWSStructureLoss::test_caws_structure_loss_equality_case_gte PASSED [ 64%]
tests/training/test_losses.py::TestCAWSStructureLoss::test_caws_structure_loss_if_statement_false_check PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_basic PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_high_entropy PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_low_entropy PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_entropy_calculation_addition_vs_subtraction PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_temperature_calculation_subtraction_vs_multiplication PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_epsilon_addition PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_kl_weight_multiplication PASSED [ 64%]
tests/training/test_losses.py::TestEntropyWeighting::test_entropy_weighting_ce_gt_weight_subtraction PASSED [ 64%]
tests/training/test_losses.py::TestLengthAwareKDLossEdgeCases::test_length_aware_kd_loss_invalid_reduction PASSED [ 64%]
tests/training/test_losses.py::TestEarlyToolCallLossEdgeCases::test_early_tool_call_loss_no_json_tokens_empty_list PASSED [ 64%]
tests/training/test_losses.py::TestEarlyToolCallLossEdgeCases::test_early_tool_call_loss_json_tokens_out_of_bounds PASSED [ 64%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_loss_mask_shape_mismatch_teacher_targets PASSED [ 64%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_loss_mask_shape_match_teacher_targets PASSED [ 64%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_loss_mask_shape_mismatch_ground_truth PASSED [ 64%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_loss_mask_shape_match_ground_truth PASSED [ 65%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_with_tool_name_loss PASSED [ 65%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_with_integration_loss PASSED [ 65%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_non_finite_total_loss_nan PASSED [ 65%]
tests/training/test_losses.py::TestCombinedKDLossEdgeCases::test_combined_kd_loss_non_finite_total_loss_inf PASSED [ 65%]
tests/training/test_losses.py::TestCAWSComplianceLossEdgeCases::test_caws_compliance_loss_claim_extraction_exception PASSED [ 65%]
tests/training/test_losses.py::TestClaimSupportedByTeacher::test_claim_supported_by_teacher_with_statement_attribute PASSED [ 65%]
tests/training/test_losses.py::TestClaimSupportedByTeacher::test_claim_supported_by_teacher_substring_containment PASSED [ 65%]
tests/training/test_losses.py::TestEarlyToolCallLossBranchCoverage::test_early_tool_call_loss_ramp_t_zero_branch PASSED [ 65%]
tests/training/test_losses.py::TestEarlyToolCallLossBranchCoverage::test_early_tool_call_loss_json_log_probs_list_empty_branch PASSED [ 65%]
tests/training/test_losses.py::TestCodeModePreferenceLossBranchCoverage::test_code_mode_preference_loss_span_boundary_check_false_branch PASSED [ 65%]
tests/training/test_losses.py::TestCodeModePreferenceLossBranchCoverage::test_code_mode_preference_loss_num_eligible_zero_return_branch PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyModelConfig::test_create_default_config PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyModelConfig::test_create_custom_config PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyModelConfig::test_gqa_ratio PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyDataset::test_create_dataset_default PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyDataset::test_create_dataset_custom_samples PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyDataset::test_create_dataset_content PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyDataset::test_create_dataset_metadata PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyDataset::test_create_dataset_parent_dir_creation PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_default PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_arch_section PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_train_section PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_io_section PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_distillation_section PASSED [ 65%]
tests/training/test_make_toy_training.py::TestCreateToyConfig::test_create_config_parent_dir_creation PASSED [ 65%]
tests/training/test_make_toy_training.py::TestMain::test_main_default_args PASSED [ 65%]
tests/training/test_make_toy_training.py::TestMain::test_main_custom_args PASSED [ 65%]
tests/training/test_make_toy_training.py::TestToyTrainingIntegration::test_full_setup_creation PASSED [ 65%]
tests/training/test_make_toy_training.py::TestToyTrainingIntegration::test_config_validity PASSED [ 65%]
tests/training/test_make_toy_training.py::TestToyTrainingIntegration::test_model_checkpoint_compatibility PASSED [ 65%]
tests/training/test_monitoring.py::TestMetricPoint::test_metric_point_creation PASSED [ 65%]
tests/training/test_monitoring.py::TestMetricPoint::test_metric_point_default_tags PASSED [ 66%]
tests/training/test_monitoring.py::TestHealthStatus::test_health_status_creation PASSED [ 66%]
tests/training/test_monitoring.py::TestHealthStatus::test_health_status_default_details PASSED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_metrics_collector_initialization FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_add_metric FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_add_metric_eviction FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_get_metrics_by_name FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_get_metrics_by_tags FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_get_latest_metric FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_get_metric_statistics FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_clear_metrics FAILED [ 66%]
tests/training/test_monitoring.py::TestMetricsCollector::test_thread_safety FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_health_checker_initialization FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_add_check FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_run_check FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_run_check_not_found FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_run_all_checks FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_get_component_status FAILED [ 66%]
tests/training/test_monitoring.py::TestHealthChecker::test_get_overall_health FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_system_health_checks_initialization FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_cpu_usage_check FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_memory_usage_check FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_gpu_check_no_gpu FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_gpu_check_with_gpu FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_disk_usage_check FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_network_connectivity_check FAILED [ 66%]
tests/training/test_monitoring.py::TestSystemHealthChecks::test_run_system_checks FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_training_monitor_initialization FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_start_monitoring FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_stop_monitoring FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_log_metric FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_log_training_step FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_log_validation_metrics FAILED [ 66%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_check_system_health PASSED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_get_monitoring_stats FAILED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_save_load_metrics FAILED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitor::test_alert_on_condition FAILED [ 67%]
tests/training/test_monitoring.py::TestInitializeMonitoring::test_initialize_monitoring_no_log_dir PASSED [ 67%]
tests/training/test_monitoring.py::TestInitializeMonitoring::test_initialize_monitoring_with_log_dir PASSED [ 67%]
tests/training/test_monitoring.py::TestConcurrencyAndPerformance::test_concurrent_metric_logging FAILED [ 67%]
tests/training/test_monitoring.py::TestConcurrencyAndPerformance::test_monitoring_performance FAILED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_record_metric_max_points_eviction PASSED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_get_metrics_with_name_filter PASSED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_get_metrics_with_start_time_filter PASSED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_get_metrics_with_end_time_filter PASSED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_get_summary_stats_empty_metrics PASSED [ 67%]
tests/training/test_monitoring.py::TestMetricsCollectorEdgeCases::test_save_to_file PASSED [ 67%]
tests/training/test_monitoring.py::TestHealthCheckerEdgeCases::test_run_checks_with_registered_checks PASSED [ 67%]
tests/training/test_monitoring.py::TestHealthCheckerEdgeCases::test_run_checks_with_metrics_collector PASSED [ 67%]
tests/training/test_monitoring.py::TestHealthCheckerEdgeCases::test_run_checks_exception_handling PASSED [ 67%]
tests/training/test_monitoring.py::TestHealthCheckerEdgeCases::test_get_overall_health PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_memory_usage_critical PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_memory_usage_warning PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_memory_usage_healthy PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_disk_usage_critical PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_disk_usage_warning PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_disk_usage_healthy PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_gpu_memory_no_gpu PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_gpu_memory_critical PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_gpu_memory_warning_branch PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_gpu_memory_healthy_branch PASSED [ 67%]
tests/training/test_monitoring.py::TestSystemHealthChecksEdgeCases::test_check_gpu_memory_exception FAILED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_start_training_records_metric PASSED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_record_step_with_all_params PASSED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_record_step_triggers_health_checks PASSED [ 67%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_run_health_checks_logs_issues PASSED [ 68%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_end_training_without_start PASSED [ 68%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_end_training_saves_files PASSED [ 68%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_get_status PASSED [ 68%]
tests/training/test_monitoring.py::TestTrainingMonitorEdgeCases::test_record_step_health_check_interval_not_exceeded PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_metrics_collector_initialization FAILED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_record_metric PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_record_metric_eviction PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_get_metrics_no_filter PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_get_metrics_by_name PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_get_metrics_by_time_range PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_get_summary_stats PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_get_summary_stats_empty PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_save_to_file PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestMetricsCollectorActual::test_thread_safety PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_health_checker_initialization PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_register_check PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_run_checks PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_run_checks_with_metrics_collector PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_run_checks_exception_handling PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestHealthCheckerActual::test_get_overall_health PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_memory_usage_healthy PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_memory_usage_warning PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_memory_usage_error PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_disk_usage_healthy PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_disk_usage_warning PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_disk_usage_error PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_gpu_memory_with_gpu_healthy PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_gpu_memory_with_gpu_warning PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_gpu_memory_with_gpu_error PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_gpu_memory_exception PASSED [ 68%]
tests/training/test_monitoring_actual.py::TestSystemHealthChecks::test_check_gpu_memory_no_gpu FAILED [ 68%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_training_monitor_initialization PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_start_training PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_record_step PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_record_step_with_gpu_memory PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_end_training PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_end_training_without_start PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_get_status FAILED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_run_health_checks_periodic PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestTrainingMonitorActual::test_run_health_checks_logs_warnings PASSED [ 69%]
tests/training/test_monitoring_actual.py::TestInitializeMonitoring::test_initialize_monitoring FAILED [ 69%]
tests/training/test_monitoring_actual.py::TestInitializeMonitoring::test_initialize_monitoring_default PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMetrics::test_performance_metrics_creation PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMetrics::test_performance_metrics_optional_fields PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_performance_monitor_initialization PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_get_metrics_basic PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_get_metrics_with_tokens PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_get_metrics_with_gpu PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_get_metrics_no_gpu PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_get_metrics_gpu_exception PASSED [ 69%]
tests/training/test_performance_monitor.py::TestPerformanceMonitor::test_reset PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTimeOperation::test_time_operation_basic PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTimeOperation::test_time_operation_with_exception PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_training_profiler_initialization PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_training_profiler_no_log_dir PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_log_step PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_log_step_multiple PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_log_step_without_tokens PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_save_profile PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_save_profile_default_path PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_save_profile_no_path PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_get_summary_stats PASSED [ 69%]
tests/training/test_performance_monitor.py::TestTrainingProfiler::test_get_summary_stats_empty PASSED [ 69%]
tests/training/test_performance_monitor.py::TestProfileMemoryUsage::test_profile_memory_usage_with_gpu PASSED [ 70%]
tests/training/test_performance_monitor.py::TestProfileMemoryUsage::test_profile_memory_usage_no_gpu PASSED [ 70%]
tests/training/test_performance_monitor.py::TestPerformanceMonitorIntegration::test_complete_profiling_workflow PASSED [ 70%]
tests/training/test_performance_monitor.py::TestPerformanceMonitorIntegration::test_monitor_with_profiler PASSED [ 70%]
tests/training/test_performance_monitor.py::TestPerformanceMonitorIntegration::test_time_operation_with_profiler PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_valid_object PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_valid_array PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_nested_object PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_in_text PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_invalid PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_malformed PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_empty_string PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_plain_text PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_multiple_objects PASSED [ 70%]
tests/training/test_process_losses.py::TestValidateJSON::test_validate_json_whitespace PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_valid PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_in_text PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_no_name PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_invalid_json PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_no_json PASSED [ 70%]
tests/training/test_process_losses.py::TestExtractToolCall::test_extract_tool_call_array PASSED [ 70%]
tests/training/test_process_losses.py::TestJSONValidityLoss::test_json_validity_loss_valid_json FAILED [ 70%]
tests/training/test_process_losses.py::TestJSONValidityLoss::test_json_validity_loss_invalid_json PASSED [ 70%]
tests/training/test_process_losses.py::TestJSONValidityLoss::test_json_validity_loss_mixed PASSED [ 70%]
tests/training/test_process_losses.py::TestJSONValidityLoss::test_json_validity_loss_empty_list PASSED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLoss::test_tool_selection_loss_basic FAILED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLoss::test_tool_selection_loss_no_tool_call PASSED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLoss::test_tool_selection_loss_empty_targets PASSED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLossFromIDs::test_tool_selection_loss_from_ids_basic FAILED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLossFromIDs::test_tool_selection_loss_from_ids_1d PASSED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLossFromIDs::test_tool_selection_loss_from_ids_empty_mask PASSED [ 70%]
tests/training/test_process_losses.py::TestToolSelectionLossFromIDs::test_tool_selection_loss_from_ids_short_sequence PASSED [ 70%]
tests/training/test_process_losses.py::TestJSONValidityLossFromIDs::test_json_validity_loss_from_ids_basic FAILED [ 71%]
tests/training/test_process_losses.py::TestJSONValidityLossFromIDs::test_json_validity_loss_from_ids_1d PASSED [ 71%]
tests/training/test_process_losses.py::TestJSONValidityLossFromIDs::test_json_validity_loss_from_ids_empty_mask PASSED [ 71%]
tests/training/test_process_losses.py::TestJSONValidityLossFromIDs::test_json_validity_loss_from_ids_decode_error PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_basic PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_with_token_ids PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_json_only PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_tool_only PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_no_tokenizer PASSED [ 71%]
tests/training/test_process_losses.py::TestProcessSupervisionLoss::test_process_supervision_loss_zero_weights PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_empty_text PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_structured_content PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_ground_truth_comparison PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_length_appropriateness PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_coherence_indicators PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_prompt_context PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_word_count_50_to_500 FAILED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_word_count_20_to_50 FAILED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_unique_ratio_high PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_unique_ratio_low PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_bounds_clamping PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_ground_truth_empty PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_prompt_empty PASSED [ 71%]
tests/training/test_quality_scoring.py::TestHeuristicQualityScore::test_compute_heuristic_quality_score_ground_truth_full_overlap FAILED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_valid_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_invalid_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_complex_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_partial_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_no_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_malformed_json PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_no_matches PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_empty_text PASSED [ 71%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_mixed_valid_invalid FAILED [ 72%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_multiple_valid_json PASSED [ 72%]
tests/training/test_quality_scoring.py::TestJSONValidityScore::test_compute_json_validity_score_multiple_invalid_json PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_python_code PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_javascript_code PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_no_code_blocks PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_inline_code PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_mixed_languages PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_syntax_quality PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_empty_code_block PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_short_code PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_no_language PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_optimal_length PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_very_long_code PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCodeBlockScore::test_compute_code_block_score_multiple_blocks_averaging PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_basic PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_minimal_text PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_structured_content PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_custom_weights PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_empty_text PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_zero_total_weight PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_partial_weights PASSED [ 72%]
tests/training/test_quality_scoring.py::TestCompositeQualityScore::test_compute_composite_quality_score_missing_metric_in_scores PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_empty_list PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_single_item PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_multiple_items PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_different_methods PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_with_ground_truth PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_mixed_content PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_error_handling PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_large_batch PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_with_prompts PASSED [ 72%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_mismatched_ground_truth_length PASSED [ 73%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_mismatched_prompts_length PASSED [ 73%]
tests/training/test_quality_scoring.py::TestBatchQualityScoring::test_batch_compute_quality_scores_longer_ground_truths_than_texts PASSED [ 73%]
tests/training/test_quality_scoring.py::TestQualityScoringIntegration::test_quality_scoring_consistency PASSED [ 73%]
tests/training/test_quality_scoring.py::TestQualityScoringIntegration::test_quality_scoring_realistic_examples PASSED [ 73%]
tests/training/test_quality_scoring.py::TestQualityScoringIntegration::test_quality_scoring_performance PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_initialization PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_forward_2d FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_forward_multiple_observations FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_get_scale_zero_point_signed PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_get_scale_zero_point_unsigned PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestMinMaxObserver::test_min_max_observer_1d_tensor FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_initialization PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_forward_training FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_forward_eval FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_signed_quantization FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_unsigned_quantization FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestFakeQuantize::test_fake_quantize_scalar_scale PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedLinear::test_quantized_linear_initialization PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedLinear::test_quantized_linear_forward FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedLinear::test_quantized_linear_no_bias PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedLinear::test_quantized_linear_different_bits FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedAttention::test_quantized_attention_initialization PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedAttention::test_quantized_attention_forward FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedAttention::test_quantized_attention_with_mask FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedAttention::test_quantized_attention_clamp_pre_softmax FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizedAttention::test_quantized_attention_no_clamp FAILED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeFunctions::test_quantize_linear PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeFunctions::test_quantize_attention PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeFunctions::test_quantize_swiglu PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeModel::test_quantize_model_basic PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeModel::test_quantize_model_with_embeddings PASSED [ 73%]
tests/training/test_quant_qat_int8.py::TestQuantizeModel::test_quantize_model_no_fake_quant_attention PASSED [ 74%]
tests/training/test_quant_qat_int8.py::TestQuantizeModel::test_quantize_model_no_clamp_pre_softmax PASSED [ 74%]
tests/training/test_quant_qat_int8.py::TestQuantizeModel::test_quantize_model_different_bits PASSED [ 74%]
tests/training/test_quant_qat_int8.py::TestLoadModelFromCheckpoint::test_load_model_from_checkpoint_success FAILED [ 74%]
tests/training/test_quant_qat_int8.py::TestLoadModelFromCheckpoint::test_load_model_from_checkpoint_no_config FAILED [ 74%]
tests/training/test_quant_qat_int8.py::TestQuantizationIntegration::test_observer_to_fake_quant_workflow FAILED [ 74%]
tests/training/test_quant_qat_int8.py::TestQuantizationIntegration::test_quantized_linear_workflow FAILED [ 74%]
tests/training/test_quant_qat_int8.py::TestQuantizationIntegration::test_quantized_model_forward FAILED [ 74%]
tests/training/test_run_manifest.py::TestGateStatus::test_gate_status_values PASSED [ 74%]
tests/training/test_run_manifest.py::TestPhaseGateStatus::test_phase_gate_status_creation PASSED [ 74%]
tests/training/test_run_manifest.py::TestPhaseGateStatus::test_phase_gate_status_defaults PASSED [ 74%]
tests/training/test_run_manifest.py::TestMetricThreshold::test_metric_threshold_creation PASSED [ 74%]
tests/training/test_run_manifest.py::TestMetricThreshold::test_metric_threshold_defaults PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_run_manifest_creation PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_run_manifest_defaults PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_to_dict PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_from_dict PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_save_json PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_save_yaml PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_load_json PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_load_yaml PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_get_phase_status PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_add_phase_gate PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_add_phase_gate_with_gates PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_add_metric PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_add_metric_failed PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_round_trip_json PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_round_trip_yaml PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifest::test_manifest_with_all_fields PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifestIntegration::test_complete_manifest_workflow PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_all_phases_passed_all_pass PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_all_phases_passed_one_fails PASSED [ 74%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_all_phases_passed_pending PASSED [ 75%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_all_phases_passed_empty PASSED [ 75%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_get_failed_gates_no_failures PASSED [ 75%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_get_failed_gates_phase_failure PASSED [ 75%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_get_failed_gates_sub_gate_failure PASSED [ 75%]
tests/training/test_run_manifest.py::TestRunManifestMethods::test_get_failed_gates_multiple_failures PASSED [ 75%]
tests/training/test_run_manifest.py::TestCreateRunManifest::test_create_run_manifest_basic PASSED [ 75%]
tests/training/test_run_manifest.py::TestCreateRunManifest::test_create_run_manifest_with_dataset_fingerprints PASSED [ 75%]
tests/training/test_run_manifest.py::TestCreateRunManifest::test_create_run_manifest_with_commit_sha PASSED [ 75%]
tests/training/test_run_manifest.py::TestCreateRunManifest::test_create_run_manifest_environment_versions PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestGetGitSHA::test_get_git_sha_success PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestGetGitSHA::test_get_git_sha_failure PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestGetGitSHA::test_get_git_sha_exception PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestGetGitSHA::test_get_git_sha_shortens PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_basic_execution PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_eight_ball_mode PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_binary_classifier_mode PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_ternary_classifier_mode PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_vocab_mismatch_warning PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_early_stopping PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillMain::test_main_checkpoint_saving PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillIntegration::test_output_path_organization PASSED [ 75%]
tests/training/test_run_toy_distill.py::TestRunToyDistillIntegration::test_model_config_creation PASSED [ 75%]
tests/training/test_teacher_cache.py::TestCacheEntry::test_cache_entry_creation PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_teacher_cache_initialization PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_put_and_get PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_cache_miss PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_with_version_mismatch PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_without_version_validation PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_with_hash_validation PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_without_hash_validation PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_put_with_metadata PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_cache_persistence PASSED [ 75%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_get_stats PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_stats_version_mismatch PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_stats_hash_mismatch PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_clear_cache PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_clear_cache_persists PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_multiple_entries PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_cache_key_generation PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_prompt_hash_computation PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_cache_file_creation PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCache::test_load_cache_from_file PASSED [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCacheIntegration::test_complete_cache_workflow ERROR [ 76%]
tests/training/test_teacher_cache.py::TestTeacherCacheIntegration::test_cache_with_version_upgrade ERROR [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_shape PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_deterministic PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_device_preservation PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_dtype PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_hot_tokens FAILED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_different_batch_sizes PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_different_seq_lengths PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherLogits::test_teacher_logits_different_vocab_sizes PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_shape PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_deterministic PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_ternary_classifier PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_binary_classifier PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_eight_ball_tokens PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_small_vocab PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_device_preservation PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_dtype PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_final_position_boost PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_question_hash_determinism PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestEightBallTeacherLogits::test_eight_ball_teacher_logits_different_batch_sizes PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherStubIntegration::test_teacher_logits_vs_eight_ball_different_seeds PASSED [ 76%]
tests/training/test_teacher_stub_toy.py::TestTeacherStubIntegration::test_both_functions_same_input_shape PASSED [ 77%]
tests/training/test_teacher_stub_toy.py::TestTeacherStubIntegration::test_deterministic_across_calls PASSED [ 77%]
tests/training/test_tokenizer_migration.py::TestVerifyTokenIDs::test_verify_token_ids_matching FAILED [ 77%]
tests/training/test_tokenizer_migration.py::TestVerifyTokenIDs::test_verify_token_ids_mismatch PASSED [ 77%]
tests/training/test_tokenizer_migration.py::TestVerifyTokenIDs::test_verify_token_ids_no_convert_method PASSED [ 77%]
tests/training/test_tokenizer_migration.py::TestResizeModelEmbeddings::test_resize_model_embeddings_basic FAILED [ 77%]
tests/training/test_tokenizer_migration.py::TestResizeModelEmbeddings::test_resize_model_embeddings_with_new_vocab_size FAILED [ 77%]
tests/training/test_tokenizer_migration.py::TestResizeModelEmbeddings::test_resize_model_embeddings_tokenizer_len FAILED [ 77%]
tests/training/test_tokenizer_migration.py::TestResizeModelEmbeddings::test_resize_model_embeddings_no_vocab_size PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_basic FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_no_tensorboard PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_with_wandb FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_no_wandb PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_json_log_disabled PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerInit::test_tracer_init_console_log_disabled PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_basic PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_with_prefix PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_multiple_steps PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_wandb FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogMetrics::test_log_metrics_json_file PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogHparams::test_log_hparams_basic PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogHparams::test_log_hparams_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogHparams::test_log_hparams_wandb FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogModelGraph::test_log_model_graph_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogModelGraph::test_log_model_graph_wandb FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogText::test_log_text_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogText::test_log_text_json_file PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogImage::test_log_image_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerLogHistogram::test_log_histogram_tensorboard FAILED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerGetMetricsSummary::test_get_metrics_summary_basic PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerGetMetricsSummary::test_get_metrics_summary_empty PASSED [ 77%]
tests/training/test_tracing.py::TestTrainingTracerSaveSummary::test_save_summary PASSED [ 78%]
tests/training/test_tracing.py::TestTrainingTracerClose::test_close_tensorboard FAILED [ 78%]
tests/training/test_tracing.py::TestTrainingTracerClose::test_close_wandb FAILED [ 78%]
tests/training/test_tracing.py::TestTrainingTracerClose::test_close_context_manager PASSED [ 78%]
tests/training/test_tracing.py::TestCreateTracerFromConfig::test_create_tracer_from_config_basic PASSED [ 78%]
tests/training/test_tracing.py::TestCreateTracerFromConfig::test_create_tracer_from_config_default_run_name PASSED [ 78%]
tests/training/test_tracing.py::TestCreateTracerFromConfig::test_create_tracer_from_config_wandb FAILED [ 78%]
tests/training/test_tracing.py::TestCreateTracerFromConfig::test_create_tracer_from_config_no_tracing_section PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_simple_tensors PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_different_tensors_different_hash PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_order_independence PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_cuda_tensors PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_mixed_devices PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_different_dtypes PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_empty_state_dict PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_single_tensor PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_large_tensors PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_detach_handling PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_buffer_operations PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_serialization_failure PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_complex_state_dict PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_hash_properties PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_metadata_included PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_dtype_included PASSED [ 78%]
tests/training/test_utils.py::TestSHA256StateDict::test_sha256_state_dict_hashlib_called PASSED [ 78%]
tests/training/test_utils.py::TestUtilsIntegration::test_sha256_state_dict_real_model_params PASSED [ 78%]
tests/training/test_utils.py::TestUtilsIntegration::test_sha256_state_dict_memory_efficiency PASSED [ 78%]
tests/training/test_utils.py::TestUtilsIntegration::test_sha256_state_dict_error_recovery PASSED [ 78%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_initialization PASSED [ 78%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_measure_wall_clock PASSED [ 78%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_measure_residency PASSED [ 78%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_check_residency_threshold_pass PASSED [ 78%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_check_residency_threshold_fail PASSED [ 79%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_compare_with_baseline_no_regression PASSED [ 79%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_compare_with_baseline_regression PASSED [ 79%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_get_model_ops_info_no_model PASSED [ 79%]
tests/unit/test_ane_monitor.py::TestANEResidencyMonitor::test_get_model_ops_info_with_model PASSED [ 79%]
tests/unit/test_ane_monitor.py::TestMeasureModelResidency::test_measure_model_residency PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicyConfig::test_default_config PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicyConfig::test_custom_config PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_initialization_defaults PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_initialization_with_hardware_profile PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_select_batch_size_interactive PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_select_batch_size_offline PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_select_batch_size_force PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_optimize_from_benchmarks PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_optimize_from_benchmarks_no_improvement PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_should_use_batch_interactive PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_should_use_batch_offline PASSED [ 79%]
tests/unit/test_batch_policy.py::TestBatchPolicy::test_get_policy_summary PASSED [ 79%]
tests/unit/test_batch_policy.py::TestCreateBatchPolicy::test_create_batch_policy PASSED [ 79%]
tests/unit/test_batch_policy.py::TestCreateBatchPolicy::test_create_batch_policy_with_profile PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_compact_format_basic PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_compact_format_dict PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_token_count_limit PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_scope_limiting PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_default_values PASSED [ 79%]
tests/unit/test_caws_compact.py::TestCAWSCompact::test_compact_vs_verbose PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_all_headers PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_code_blocks PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_empty_text PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_json PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_markdown_headers PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_many_words PASSED [ 79%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_score_with_medium_words PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_extract_structure_elements PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_extract_structure_elements_empty_text PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_extract_structure_elements_none PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_batch_scoring PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureScore::test_batch_scoring_empty_list PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureLoss::test_loss_when_student_lower PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureLoss::test_loss_when_student_higher PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureLoss::test_loss_when_equal PASSED [ 80%]
tests/unit/test_caws_structure.py::TestCAWSStructureLoss::test_loss_requires_grad PASSED [ 80%]
tests/unit/test_code_mode_loss.py::test_code_mode_loss_is_differentiable PASSED [ 80%]
tests/unit/test_code_mode_loss.py::test_code_mode_loss_eligibility_filtering PASSED [ 80%]
tests/unit/test_code_mode_loss.py::test_code_mode_loss_vectorized_eligibility PASSED [ 80%]
tests/unit/test_code_mode_loss_torchscript.py::test_code_mode_loss_torchscript SKIPPED [ 80%]
tests/unit/test_code_mode_loss_torchscript.py::test_code_mode_loss_forward_method_torchscript PASSED [ 80%]
tests/unit/test_code_mode_weight_scheduler.py::test_code_mode_weight_scheduler PASSED [ 80%]
tests/unit/test_code_mode_weight_scheduler.py::test_code_mode_weight_scheduler_zero_warmup PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_training_config_schema_structure PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_training_config_valid PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_training_config_missing_required PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_training_config_invalid_types PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_training_config_invalid_enum PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_config_file_valid_yaml PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_config_file_invalid_yaml PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigSchemaValidation::test_validate_config_file_nonexistent PASSED [ 80%]
tests/unit/test_config_validation.py::TestDefaultConfigCreation::test_create_default_config_structure PASSED [ 80%]
tests/unit/test_config_validation.py::TestDefaultConfigCreation::test_create_default_config_values PASSED [ 80%]
tests/unit/test_config_validation.py::TestDefaultConfigCreation::test_save_config_template PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigMerging::test_merge_configs_basic PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigMerging::test_merge_configs_overrides PASSED [ 80%]
tests/unit/test_config_validation.py::TestConfigMerging::test_merge_configs_empty_list FAILED [ 80%]
tests/unit/test_config_validation.py::TestConfigMerging::test_merge_configs_invalid_file PASSED [ 80%]
tests/unit/test_config_validation.py::TestDeepMerge::test_deep_merge_nested_dicts PASSED [ 81%]
tests/unit/test_config_validation.py::TestDeepMerge::test_deep_merge_non_dict_values PASSED [ 81%]
tests/unit/test_config_validation.py::TestConfigFileValidationEdgeCases::test_validate_config_file_json_format PASSED [ 81%]
tests/unit/test_config_validation.py::TestConfigFileValidationEdgeCases::test_validate_config_file_yaml_parse_error PASSED [ 81%]
tests/unit/test_config_validation.py::TestConfigFileValidationEdgeCases::test_validate_config_file_json_parse_error PASSED [ 81%]
tests/unit/test_config_validation.py::TestConfigFileValidationEdgeCases::test_validate_config_file_unexpected_error PASSED [ 81%]
tests/unit/test_config_validation.py::TestConfigFileValidationEdgeCases::test_validate_config_file_with_validation_errors PASSED [ 81%]
tests/unit/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_yaml PASSED [ 81%]
tests/unit/test_config_validation.py::TestSaveConfigTemplate::test_save_config_template_json PASSED [ 81%]
tests/unit/test_config_validation.py::TestMergeConfigsEdgeCases::test_merge_configs_file_not_found PASSED [ 81%]
tests/unit/test_config_validation.py::TestMergeConfigsEdgeCases::test_merge_configs_json_format PASSED [ 81%]
tests/unit/test_config_validation.py::TestMergeConfigsEdgeCases::test_merge_configs_validate_final_valid PASSED [ 81%]
tests/unit/test_config_validation.py::TestMergeConfigsEdgeCases::test_merge_configs_validate_final_invalid PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_start PASSED    [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_inside_string_detection PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_step_chars_allowed_outside_string PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_step_chars_allowed_inside_string PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_step_chars_allowed_complete PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_push_text_valid_json PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestJSONFSM::test_push_text_invalid_json PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_valid_object PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_missing_required PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_wrong_type_string PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_wrong_type_number PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_wrong_type_boolean PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_wrong_type_object PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_wrong_type_array PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_not_object PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_validate_extra_fields PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestSchemaValidator::test_set_schema PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestTokenLexicon::test_token_text PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestTokenLexicon::test_tokenizer_vocab_size PASSED [ 81%]
tests/unit/test_constrained_decode.py::TestTokenLexicon::test_candidates_for_chars PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestTokenLexicon::test_by_first_map_built PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_init PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_init_with_registry PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_start PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_allowed_token_mask_empty PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_allowed_token_mask_inside_string PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_allowed_token_mask_eos_token PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_push_token PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_finalize_valid_json PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_finalize_invalid_json PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_finalize_schema_validation_failure PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestJSONConstrainedDecoder::test_end_to_end_simple PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestDecoderIntegration::test_with_real_tokenizer SKIPPED [ 82%]
tests/unit/test_constrained_decode.py::TestDecoderIntegration::test_dynamic_schema_switching PASSED [ 82%]
tests/unit/test_constrained_decode.py::TestDecoderIntegration::test_start_resets_schema PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_synthesize_prompt_basic PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_synthesize_prompt_control_case PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_synthesize_prompt_with_integration PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_all_scenarios PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_all_complexities PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_all_structures PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_adversarial_range_violation PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_adversarial_malformed_json PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_adversarial_ambiguity PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_multilingual_generation PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_long_context_token_aware PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_long_context_byte_based PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_stratification_enforcement PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_tool_result_fields_dict PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_control_case_decline PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_compact_caws_header PASSED [ 82%]
tests/unit/test_contextual_generation.py::TestGenerateContextualPrompts::test_normalize_text PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_extract_process_step_targets_basic PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_extract_process_step_targets_control_case PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_extract_process_step_targets_preserves_tool_result_fields PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_multi_call_extraction PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_token_span_alignment_edge_cases PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_normalization_preservation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_control_case_filtering PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_error_handling_invalid_tokenizer PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_integration_field_extraction PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_preserve_existing_metadata PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_validate_json_args PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_validate_json_args_invalid PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestExtractProcessTargets::test_extract_with_normalized_text PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_item_basic PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_item_control_case PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_compute_integration_f1 PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounded_values_in_span PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_is_long_context_item PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_caws_header_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_privacy_scanning PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_semantic_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_stratification_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_multi_call_parity PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounding_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_integration_f1_edge_cases PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_error_handling_malformed_items PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_contains_grounding PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_parse_tool_json_slice PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_stratification_backbone PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_token_alignment PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_retry_case_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_range_violation_validation PASSED [ 83%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_malformed_json_validation PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_ambiguity_validation PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_multi_call_span_validation PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_token_alignment_with_tokenizer PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_low_integration_f1_detection PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_unknown_tool_detection PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_retry_insufficient_attempts PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_retry_last_attempt_failed PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_retry_missing_spans_or_attempts PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_missing_json_args_span PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_json_parse_fail PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_range_violation_not_handled PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_malformed_json_not_repaired PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_adversarial_ambiguity_not_clarified PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_multi_call_span_out_of_bounds PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_integration_not_grounded PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_low_integration_f1_flagging PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_is_long_context_with_tokenizer PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_is_long_context_fallback_to_bytes PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_is_long_context_item_with_tokenizer PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_is_long_context_item_tokenizer_exception PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_contains_grounding_with_synonyms PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_contains_grounding_no_spans PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_contains_grounding_no_fields PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_stratification_backbone_small_n PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_stratification_backbone_large_n PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_basic PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_invalid_json PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_with_tokenizer PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_with_schema_validation PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_schema_validation_errors PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_unknown_tool_detection PASSED [ 84%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_integration_f1_calculation PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_long_context_counting PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_stratification_check PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_with_prompt_spans_target PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_empty_lines_skipped PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_schema_file_not_found PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_tokenizer_exception PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_eligible_results_calculation PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_integration_misses_tracking PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_grounding_misses_tracking PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_multi_call_parity_tracking PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_gate_failures PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_adversarial_quota_check PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_main_function_long_context_quota_check PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounded_values_in_span_numeric PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounded_values_in_span_url PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounded_values_in_span_empty_seg PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_grounded_values_in_span_empty_fields PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_token_alignment_failure PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_token_alignment_invalid_span PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_verify_token_alignment_exception PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_semantic_validation_invalid_args PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_multi_call_parity_mismatch PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_multi_call_name_span_mismatch PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_parse_tool_json_slice_no_braces PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_parse_tool_json_slice_exception PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_privacy_url_not_allowlisted PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_privacy_multiple_emails PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_privacy_multiple_uuids PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_caws_header_exception PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestVerifyContextualSet::test_check_caws_header_missing_keys PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_missing_dependencies PASSED [ 85%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_invalid_inputs PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_file_io_errors PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_tokenizer_errors PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_memory_errors PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_json_parse_errors PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_empty_inputs PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_load_tokenizer_success PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_load_tokenizer_import_error PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_load_tokenizer_general_exception PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_main_function_basic PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_main_function_empty_file PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestErrorHandling::test_main_function_json_error PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_fast_tokenizer_offsets PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_slow_tokenizer_fallback PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_normalize_text_nfc PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_normalize_text_lf PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_normalize_text_both PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_empty_spans PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_out_of_bounds_spans PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_unicode_handling PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_byte_spans_to_token_spans_multiple PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_byte_spans_to_token_spans_slow_fallback PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestUtilTokenSpans::test_tokenizer_exception_fallback PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_eligibility_filter_off_by_one PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_control_case_not_removed PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_empty_list_vs_none PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_span_cap_off_by_one PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_multi_call_parity_empty PASSED [ 86%]
tests/unit/test_contextual_generation.py::TestNegativeMutationSimulation::test_token_alignment_boundary PASSED [ 86%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_initialization PASSED [ 86%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_loads_jsonl PASSED [ 86%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_getitem PASSED   [ 86%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_with_teacher_logits PASSED [ 87%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_truncation PASSED [ 87%]
tests/unit/test_dataset.py::TestKDDataset::test_dataset_labels_shifted PASSED [ 87%]
tests/unit/test_dataset.py::TestCollateKDBatch::test_collate_basic PASSED [ 87%]
tests/unit/test_dataset.py::TestCollateKDBatch::test_collate_with_teacher_logits PASSED [ 87%]
tests/unit/test_dataset.py::TestCollateKDBatch::test_collate_variable_length PASSED [ 87%]
tests/unit/test_dataset.py::TestCollateKDBatch::test_collate_pads_labels_with_ignore_index PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_initialization PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_getitem_basic PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_prompt_formatting PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_empty_tools PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_missing_fields PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_dataset_file_not_found PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestAnswerGenerationDataset::test_collate_answer_generation_batch PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestPostToolDataset::test_dataset_initialization PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestPostToolDataset::test_dataset_getitem PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestPostToolDataset::test_dataset_tool_result_formatting PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestPostToolDataset::test_collate_post_tool_batch PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestPostToolDataset::test_dataset_with_empty_lines PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_initialization PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_getitem PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_tool_formatting PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_empty_tools PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_collate_tool_select_batch PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_json_formatting PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestToolSelectDataset::test_dataset_with_empty_lines PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestDatasetErrorHandling::test_answer_generation_invalid_json PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestDatasetErrorHandling::test_datasets_empty_file PASSED [ 87%]
tests/unit/test_dataset_modules.py::TestDatasetErrorHandling::test_datasets_whitespace_only_lines PASSED [ 87%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_high_entropy_high_temperature PASSED [ 87%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_low_entropy_low_temperature PASSED [ 87%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_entropy_computation PASSED [ 87%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_temperature_range PASSED [ 88%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_weight_normalization PASSED [ 88%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_entropy_clamping PASSED [ 88%]
tests/unit/test_entropy_scheduling.py::TestEntropyWeighting::test_entropy_vs_linear_schedule PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestSampleEnumeratedShape::test_default_production_mix_4_shapes PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestSampleEnumeratedShape::test_custom_shape_probs FAILED [ 88%]
tests/unit/test_enumerated_shapes.py::TestSampleEnumeratedShape::test_periodic_upweight_rare PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestSampleEnumeratedShape::test_no_periodic_upweight PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestTruncateBatchToShape::test_truncate_sequence_keys PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestTruncateBatchToShape::test_truncate_sequence_vocab_keys PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestTruncateBatchToShape::test_no_truncation_when_shorter PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestTruncateBatchToShape::test_preserve_metadata_keys PASSED [ 88%]
tests/unit/test_enumerated_shapes.py::TestTruncateBatchToShape::test_all_sequence_keys_truncated PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_valid_json PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_embedded PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_no_match PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_with_tool_names PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_invalid_json_in_match PASSED [ 88%]
tests/unit/test_extractors.py::TestToolCallExtraction::test_extract_tool_call_invalid_json_entire_text PASSED [ 88%]
tests/unit/test_extractors.py::TestToolNameSpanExtraction::test_extract_tool_name_span_found PASSED [ 88%]
tests/unit/test_extractors.py::TestToolNameSpanExtraction::test_extract_tool_name_span_not_found PASSED [ 88%]
tests/unit/test_extractors.py::TestToolNameSpanExtraction::test_extract_tool_name_span_json PASSED [ 88%]
tests/unit/test_extractors.py::TestToolNameSpanExtraction::test_extract_tool_name_span_with_next_sentence PASSED [ 88%]
tests/unit/test_extractors.py::TestJSONArgumentSpanExtraction::test_extract_json_argument_spans_simple PASSED [ 88%]
tests/unit/test_extractors.py::TestJSONArgumentSpanExtraction::test_extract_json_argument_spans_multiple PASSED [ 88%]
tests/unit/test_extractors.py::TestJSONArgumentSpanExtraction::test_extract_json_argument_spans_nested PASSED [ 88%]
tests/unit/test_extractors.py::TestJSONArgumentSpanExtraction::test_extract_json_argument_spans_no_json PASSED [ 88%]
tests/unit/test_extractors.py::TestJSONArgumentSpanExtraction::test_extract_json_argument_spans_invalid_json PASSED [ 88%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_with_results PASSED [ 88%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_no_results PASSED [ 88%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_patterns PASSED [ 88%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_numeric_values PASSED [ 88%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_list_values PASSED [ 89%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_list_short_first_item PASSED [ 89%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_with_markers PASSED [ 89%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_marker_with_end_match PASSED [ 89%]
tests/unit/test_extractors.py::TestIntegrationSpanIdentification::test_identify_integration_spans_marker_without_end_match PASSED [ 89%]
tests/unit/test_extractors.py::TestMergeOverlappingSpans::test_merge_overlapping_spans_empty PASSED [ 89%]
tests/unit/test_extractors.py::TestMergeOverlappingSpans::test_merge_overlapping_spans_non_overlapping PASSED [ 89%]
tests/unit/test_extractors.py::TestMergeOverlappingSpans::test_merge_overlapping_spans_overlapping PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRMSNorm::test_rmsnorm_forward PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRMSNorm::test_rmsnorm_normalization PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRMSNorm::test_rmsnorm_gradient_flow PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestSwiGLU::test_swiglu_forward PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestSwiGLU::test_swiglu_gradient_flow PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRotaryEmbedding::test_rope_apply PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRotaryEmbedding::test_rope_apply_single PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRotaryEmbedding::test_rope_scaling_dynamic PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestRotaryEmbedding::test_rope_rotation_property PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestMHAGQA::test_mha_gqa_forward PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestMHAGQA::test_mha_gqa_with_mask PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestMHAGQA::test_mha_gqa_forward_decode PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestMHAGQA::test_mha_gqa_gqa_expansion PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestBlock::test_block_forward PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestBlock::test_block_residual_connection PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestBlock::test_block_forward_decode PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestStudentLM::test_studentlm_forward PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestStudentLM::test_studentlm_forward_with_mask PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestStudentLM::test_studentlm_forward_decode PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestStudentLM::test_studentlm_gradient_flow PASSED [ 89%]
tests/unit/test_gqa_transformer.py::TestStudentLM::test_studentlm_default_config +++++++++++++++++++++++++++++++++++ Timeout ++++++++++++++++++++++++++++++++++++
~~~~~~~~~~~~~~~~~~~~~~~ Stack of MainThread (8409374912) ~~~~~~~~~~~~~~~~~~~~~~~
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/bin/pytest", line 7, in <module>
    sys.exit(console_main())
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/config/__init__.py", line 221, in console_main
    code = main()
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/config/__init__.py", line 197, in main
    ret: ExitCode | int = config.hook.pytest_cmdline_main(config=config)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/main.py", line 365, in pytest_cmdline_main
    return wrap_session(config, _main)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/main.py", line 318, in wrap_session
    session.exitstatus = doit(config, session) or 0
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/main.py", line 372, in _main
    config.hook.pytest_runtestloop(session=session)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/main.py", line 396, in pytest_runtestloop
    item.config.hook.pytest_runtest_protocol(item=item, nextitem=nextitem)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 118, in pytest_runtest_protocol
    runtestprotocol(item, nextitem=nextitem)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 137, in runtestprotocol
    reports.append(call_and_report(item, "call", log))
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 244, in call_and_report
    call = CallInfo.from_call(
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 353, in from_call
    result: TResult | None = func()
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 245, in <lambda>
    lambda: runtest_hook(item=item, **kwds),
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/runner.py", line 179, in pytest_runtest_call
    item.runtest()
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/python.py", line 1720, in runtest
    self.ihook.pytest_pyfunc_call(pyfuncitem=self)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_hooks.py", line 512, in __call__
    return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_manager.py", line 120, in _hookexec
    return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/pluggy/_callers.py", line 121, in _multicall
    res = hook_impl.function(*args)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/_pytest/python.py", line 166, in pytest_pyfunc_call
    result = testfunction(**testargs)
  File "/Users/darianrosebrook/Desktop/Projects/distill/tests/unit/test_gqa_transformer.py", line 371, in test_studentlm_default_config
    model = StudentLM(cfg).to(device)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1371, in to
    return self._apply(convert)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    module._apply(fn)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    module._apply(fn)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 930, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 957, in _apply
    param_applied = fn(param)
  File "/Users/darianrosebrook/Desktop/Projects/distill/venv/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1357, in convert
    return t.to(
+++++++++++++++++++++++++++++++++++ Timeout ++++++++++++++++++++++++++++++++++++
